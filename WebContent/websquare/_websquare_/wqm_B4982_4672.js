(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[4672],{4672:(e,t,i)=>{"use strict";i.r(t),i.d(t,{treeview_virtual:()=>p});var o=i(2981),s=i(3082),a=i(7275),l=function(){this.index=0,this.depthIndex=0,this.id="",this.label="",this.orgLabel="",this.value="",this.element=null,this.depth=-1,this.parentNode=null,this.childNodes=[],this._isRoot=null,this._hasChild=null,this._isLastChild=null,this.image="",this.selectedImage="",this.expandedImage="",this.checked=!1,this.folder=null,this.expandedNodes=[],this._isExpanded=!1,this._ancestor=0};l.prototype.appendChild=function(e){if(e){var t=this;do{if(e==t)return!1;t=t.parentNode}while(t);if(e.parentNode){for(var i=0;i<e.parentNode.expandedNodes.length;i++){if(e==e.parentNode.expandedNodes[i]){e.parentNode.expandedNodes.splice(i,1);break}}e.parentNode.removeChild(e)}return e.parentNode=this,this.depth>=1&&(e._ancestor=this._ancestor),this.childNodes.push(e),!0}},l.prototype.removeChild=function(e){if(e){for(var t=[],i=0;i<this.childNodes.length;i++){var o=this.childNodes[i];o!=e&&t.push(o)}this.childNodes=t}},l.prototype.isRoot=function(){return this._isRoot=null,this._isRoot=null==this.parentNode,this._isRoot},l.prototype.hasChild=function(){return this._hasChild=null,this.folder?this.folder:(this._hasChild=0!=this.childNodes.length,this._hasChild=0!=this.childNodes.length,this._hasChild)},l.prototype.isLeaf=function(){return!this.hasChild()},l.prototype.isFirstChild=function(){var e=!1;return this.parentNode?(this.parentNode.childNodes[0]&&this===this.parentNode.childNodes[0]&&(e=!0),e):e},l.prototype.isLastChild=function(){if(this._isLastChild=null,!this.parentNode)return!0;var e=this.parentNode.childNodes;return e[e.length-1]==this&&(this._isLastChild=!0),1!=this._isLastChild&&(this._isLastChild=!1),this._isLastChild},l.prototype.hasSibling=function(){return this._isLastChild=null,!!this.parentNode&&1!=this.parentNode.childNodes.length},l.prototype.isExpanded=function(){if(this._isExpanded=!1,this.hasChild()){for(var e=0;e<this.parentNode.expandedNodes.length;e++)if(this.index==this.parentNode.expandedNodes[e].index){this._isExpanded=!0;break}return this._isExpanded}return!1},l.prototype.isFirstChildByRoot=function(){var e=!1;return this.parentNode?(0!=this.parentNode.depth||this.parentNode.childNodes[0]&&this===this.parentNode.childNodes[0]&&(e=!0),e):e},(l.nodeIterator=function(e,t){this.node=e,this.status=0,this.options=o.x.extend({type:"dfs",pruning:null},o.x.extend({},t)),this.stack=[]}).prototype.next=function(){return!!this.node&&(0==this.status?(this.status=1,!0):("dfs"==this.options.type?(this.stack=this.node.childNodes.concat(this.stack),this.node=this.stack.shift()):"bfs"==this.options.type&&(this.stack=this.stack.concat(this.node.childNodes),this.node=this.stack.shift()),!!this.node))},l.nodeIterator.prototype.stop=function(){this.status=2},l.nodeIterator.prototype.getNode=function(){return this.node};var h=function(){this.nodeCount=0,this.rootNode=null,this.hash_index_node={},this.useXPath=!1,this.useCheckbox=!1,this.useImage=!1;this.xpath={nodeset:"",label:"w2:label",value:"w2:value",depth:"w2:depth",nodeName:"w2:node",checkbox:"",folder:"w2:folder"},this.dataPath={},this.imageXPath={image:"",iconImage:"",leafImage:"",selectedImage:"",expandedImage:""},this.checkbox={xpath:"",trueValue:"",falseValue:"",checkboxDisabled:"",checkboxDisabledTrueValue:"",checkboxDisabledFalseValue:"",checkboxDisabledAll:""},this.valueAttribute="",this.displayMode="0",this.delimiter="\t",this.customFormatter="",this.treeView="",this.maxDepth=-1,this.isInstance=!1};h.prototype.getNodeset=function(){if(""!=this.xpath.nodeset)return this.xpath.nodeset},h.prototype.setXPath=function(e,t,i,o,s,a,l){""!=e&&(this.useXPath=!0,this.xpath.nodeset=e,this.xpath.label=t,this.xpath.value=i,this.xpath.depth=o,this.xpath.nodeName=s,this.xpath.folder=a,this.xpath.auth=l)},h.prototype.setDataPath=function(e,t,i,o,s,a){this.dataPath.label=e,this.dataPath.value=t,this.dataPath.depth=i,
this.dataPath.nodeName=o,this.dataPath.folder=s,this.dataPath.checkbox=a},h.prototype.setCheckbox=function(e,t,i,o,s,a,l,h,n,d,r){""!=e&&(this.useCheckbox=!0,this.checkbox.xpath=e,this.checkbox.trueValue=t,this.checkbox.falseValue=i,this.checkbox.checkboxDisabled=o,this.checkbox.checkboxDisabledTrueValue=s,this.checkbox.checkboxDisabledFalseValue=a,this.checkbox.checkboxDisabledAll=l,this.checkbox.refreshCheckboxModel=h,this.checkbox.refreshCheckboxDisableModel=n,this.checkbox.hierarchy=d,this.checkbox.colID=r)},h.prototype.setDisplayMode=function(e,t){this.displayMode=e,this.delimiter=t},h.prototype.setImage=function(e,t,i,o,s,a){this.useImage=!0,this.imageXPath.image=e||"",this.imageXPath.iconImage=t||"",this.imageXPath.leafImage=i||"",this.imageXPath.selectedImage=o||"",this.imageXPath.expandedImage=s||"",this.imageXPath.imageTitle=a||""},h.prototype.setXML=function(e){e&&(this.nodeCount=0,this.rootNode=null,this.hash_index_node={},1==this.isInstance?(this.rootNode=this.parseNodeInstance(e,0,0),1==this.useImage&&this.parseImageInstance(this.rootNode)):(this.rootNode=this.parseNode(e,0,0),1==this.useImage&&this.parseImage(this.rootNode)))},h.prototype.setDataList=function(e){var t=s.D.getComponentById(e);if(t){this.rootNode=new l,this.nodeCount=0,this.hash_index_node[this.rootNode.index]=this.rootNode,this.dataType="list";for(var i=t.getAllFilteredJSON(),o=this.rootNode,h=0;h<i.length;h++){var n=i[h],d=parseInt(n[this.dataPath.depth],10)||0,r=o.depth,c=new l;c.index=++this.nodeCount,c.depth=d,c.element=n,c.orgLabel=n[this.dataPath.label],c.label=n[this.dataPath.label],c.value=n[this.dataPath.value],c.folder=n[this.dataPath.folder];var p=c.label;switch(this.displayMode){case"0":c.label=p;break;case"1":c.label=c.value+this.delimiter+p;break;case"2":c.label=p+this.delimiter+c.value;break;default:c.label=p}if(1==this.useCheckbox&&n[this.dataPath.checkbox])if(n[this.dataPath.checkbox].wq_trim()==this.checkbox.trueValue?(c.checked=!0,1==this.checkbox.refreshCheckboxModel&&t.setCellData(h,this.dataPath.checkbox,this.checkbox.trueValue)):(c.checked=!1,1==this.checkbox.refreshCheckboxModel&&t.setCellData(h,this.dataPath.checkbox,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){var u=n[this.checkbox.checkboxDisabled].wq_trim();1==this.checkbox.checkboxDisabledAll?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(h,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledTrueValue)):(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(h,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledFalseValue)),u==this.checkbox.checkboxDisabledTrueValue?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(h,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledTrueValue)):u==this.checkbox.checkboxDisabledFalseValue&&(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&t.setCellData(h,this.checkbox.checkboxDisabled,this.checkbox.checkboxDisabledFalseValue))}if("function"==typeof this.customFormatter){var f=this.customFormatter,m=this.getCloneNode(c);c.label=f.call(this.treeview,c.orgLabel,c.label,m)||c.label}if(d<=0?a.k.printLog("["+e+"] depth 값은 양의정수여야 합니다. (1 이상)"):1==d&&(c._ancestor=c.index),r<d)o.appendChild(c);else if(r==d)o.parentNode.appendChild(c);else if(r>d){o=o.parentNode;for(var g=0;g<r-d&&null!=o.parentNode;g++)o=o.parentNode;o.appendChild(c)}o=c}var b=function(e,t,i){if(i){i.depthIndex=t,i.depth=e,e>this.maxDepth&&(this.maxDepth=e);for(var o=0,s=0;s<i.childNodes.length;s++)b.call(this,e+1,o++,i.childNodes[s]);this.hash_index_node[i.index]=i}};b.call(this,0,0,this.rootNode),1==this.useImage&&this.parseDataListImage(this.rootNode)}},h.prototype.setData=function(e){if(e&&null!=e.data)switch(this.nodeCount=0,this.rootNode=null,this.hash_index_node={},e.type){case"dataList":this.setDataList(e.data);break;case"xmlInstance":case"inlineXML":this.setXML(e.data)}},h.prototype.appendXML=function(e,t){if(e){
var i=this.findNodeByIndex(t),o=i.element,s=1;if(1==this.isInstance){for(var a=e.firstChild;null!=a;a=e.firstChild)1==a.nodeType&&a.tagName==this.xpath.nodeName&&i.appendChild(this.parseNodeInstance(a,i.depth+1,s++,i)),o.appendChild(e.removeChild(a));1==this.useImage&&this.parseImageInstance(i)}else{for(var l=e.getChildNodes(),h=0;h<l.length;h++)1==(a=l[h]).nodeType&&a.getTagName()==this.xpath.nodeName&&i.appendChild(this.parseNode(a,i.depth+1,s++,i)),o.appendChild(e.removeChild(a));1==this.useImage&&this.parseImage(i)}return i}},h.prototype.parseNode=function(e,t,i,o){if(!e)return null;var s=WebSquare.jsonUtil.getValue(e._element,this.xpath.label,this.valueAttribute),a=null,h=this.xpath.auth&&WebSquare.jsonUtil.getValue(e._element,this.xpath.auth,this.valueAttribute);if(this.xpath.folder)a=WebSquare.jsonUtil.getValue(e._element,this.xpath.folder,this.valueAttribute);for(var n="",d=this.xpath.value.split(" "),r=0;r<d.length;r++)0!=r&&(n+="$$"),n+=WebSquare.jsonUtil.getValue(e._element,d[r],this.valueAttribute);var c=new l;switch(c.index=this.nodeCount++,c.depthIndex=i,this.displayMode){case"0":c.label=s;break;case"1":c.label=n+this.delimiter+s;break;case"2":c.label=s+this.delimiter+n;break;default:c.label=s}if(c.orgLabel=c.label,c.value=n,c.element=e,c.depth=t,c.folder=a,c.auth=h,o&&(c._ancestor=o._ancestor),t>this.maxDepth&&(this.maxDepth=t),1==t?(this.xpath.value?c.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+c.value+"']":c.xpath=this.xpath.nodeset,c._ancestor=c.index):t>1&&("recursive"==this.dataType?this.xpath.value?c.xpath=o.xpath+"/"+this.xpath.nodeName+"["+this.xpath.value+"='"+c.value+"']":c.xpath=o.xpath+"/"+this.xpath.nodeName:this.xpath.value?c.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+c.value+"']":c.xpath=this.xpath.nodeset),1==this.useCheckbox){var p=WebSquare.jsonUtil.getValue(e._element,this.checkbox.xpath,this.valueAttribute);if(c.checkboxXPath=c.xpath+"/"+this.checkbox.xpath,p==this.checkbox.trueValue?(c.checked=!0,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxXPath,this.checkbox.trueValue)):(c.checked=!1,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxXPath,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){c.checkboxDisableXPath=c.xpath+"/"+this.checkbox.checkboxDisabled;var u=WebSquare.jsonUtil.getValue(e._element,this.checkbox.checkboxDisabled,this.valueAttribute);1==this.checkbox.checkboxDisabledAll?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue)),u==this.checkbox.checkboxDisabledTrueValue?(c.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):u==this.checkbox.checkboxDisabledFalseValue&&(c.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(c.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue))}}var f=0,m=e.getChildNodes();for(r=0;r<m.length;r++){var g=m[r];1==g.nodeType&&g.getTagName()==this.xpath.nodeName&&c.appendChild(this.parseNode(g,t+1,f++,c))}if(1==this.useCheckbox&&1==this.checkbox.hierarchy){var b=0,x=!1;for(r=0;r<c.childNodes.length;r++){var v=c.childNodes[r];1==v.checked?b++:1==v.partial&&(x=!0)}1==x||0<b&&b<c.childNodes.length?c.partial=!0:b>0&&b==c.childNodes.length?(c.checked=!0,c.checkboxDom||(c.checkboxDom=document.getElementById(this.treeview.id+"_checkbox_"+c.index)),c.checkboxDom&&(c.checkboxDom.checked=!0)):c.partial=!1}if(this.hash_index_node[c.index]=c,"function"==typeof this.customFormatter){var y=this.customFormatter,_=this.getCloneNode(c),k=y.call(this.treeview,c.orgLabel,c.label,_)||c.label;c.label=k}return c},
h.prototype.parseNodeInstance=function(e,t,i,o){if(!e)return null;var a=WebSquare.xml.getValue(e,this.xpath.label).wq_trim(),h=null,n=this.xpath.auth&&WebSquare.xml.getValue(e,this.xpath.auth).wq_trim();this.xpath.folder&&(h=s.D.getBoolean(WebSquare.xml.getValue(e,this.xpath.folder).wq_trim()));for(var d="",r=this.xpath.value.split(" "),c=0;c<r.length;c++)0!=c&&(d+="$$"),d+=WebSquare.xml.getValue(e,r[c]).wq_trim();var p=new l;switch(p.index=this.nodeCount++,p.depthIndex=i,this.displayMode){case"0":p.label=a;break;case"1":p.label=d+this.delimiter+a;break;case"2":p.label=a+this.delimiter+d;break;default:p.label=a}if(p.orgLabel=p.label,p.value=d,p.element=e,p.depth=t,p.folder=h,p.auth=n,o&&(p._ancestor=o._ancestor),t>this.maxDepth&&(this.maxDepth=t),1==t?(this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset,p._ancestor=p.index):t>1&&("recursive"==this.dataType?this.xpath.value?p.xpath=o.xpath+"/"+this.xpath.nodeName+"["+this.xpath.value+"='"+p.value+"']":p.xpath=o.xpath+"/"+this.xpath.nodeName:this.xpath.value?p.xpath=this.xpath.nodeset+"["+this.xpath.value+"='"+p.value+"']":p.xpath=this.xpath.nodeset),1==this.useCheckbox){var u=WebSquare.xml.getValue(e,this.checkbox.xpath).wq_trim();if(p.checkboxXPath=p.xpath+"/"+this.checkbox.xpath,u==this.checkbox.trueValue?(p.checked=!0,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.trueValue)):(p.checked=!1,1==this.checkbox.refreshCheckboxModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxXPath,this.checkbox.falseValue)),this.checkbox.checkboxDisabled){p.checkboxDisableXPath=p.xpath+"/"+this.checkbox.checkboxDisabled;var f=WebSquare.xml.getValue(e,this.checkbox.checkboxDisabled).wq_trim();1==this.checkbox.checkboxDisabledAll?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue)),f==this.checkbox.checkboxDisabledTrueValue?(p.checkboxDisabled=!0,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledTrueValue)):f==this.checkbox.checkboxDisabledFalseValue&&(p.checkboxDisabled=!1,1==this.checkbox.refreshCheckboxDisableModel&&WebSquare.ModelUtil.setInstanceValue(p.checkboxDisableXPath,this.checkbox.checkboxDisabledFalseValue))}}for(var m=0,g=e.firstChild;null!=g;g=g.nextSibling)1==g.nodeType&&g.tagName==this.xpath.nodeName&&p.appendChild(this.parseNodeInstance(g,t+1,m++,p));if(1==this.useCheckbox&&1==this.checkbox.hierarchy){var b=0,x=!1;for(c=0;c<p.childNodes.length;c++){var v=p.childNodes[c];1==v.checked?b++:1==v.partial&&(x=!0)}1==x||0<b&&b<p.childNodes.length?p.partial=!0:b>0&&b==p.childNodes.length?(p.checked=!0,p.checkboxDom||(p.checkboxDom=document.getElementById(this.treeview.id+"_checkbox_"+p.index)),p.checkboxDom&&(p.checkboxDom.checked=!0)):p.partial=!1}if(this.hash_index_node[p.index]=p,"function"==typeof this.customFormatter){var y=this.customFormatter,_=this.getCloneNode(p),k=y.call(this.treeview,p.orgLabel,p.label,_)||p.label;p.label=k}return p},h.prototype.parseNodeByNode=function(e,t,i,o){if(!e)return null;var s=new l;s.index=e.index,s.depthIndex=i,s.parentNode=o,s.label=e.label,s.orgLabel=s.label,s.value=e.value,s.element=this.getCloneNodeElemnt(e.element),s.depth=t,s.folder=e.folder,s.xpath="",s.checkboxXPath="",s.selectedImage=e.selectedImage,s.expandedImage=e.expandedImage,s.image=e.image,s.imageTitle=e.imageTitle,s.labelStyle=e.labelStyle,s.expandedNodes=e.expandedNodes.splice(0),void 0!==e.checked&&(s.checked=e.checked),s.checkboxDisableXPath="",void 0!==e.checkboxDisabled&&(s.checkboxDisabled=e.checkboxDisabled)
;for(var a=0,h=0;h<e.childNodes.length;h++)s.appendChild(this.parseNodeByNode(e.childNodes[h],t+1,a++,s,o));return this.hash_index_node[s.index]=s,s},h.prototype.parseImage=function(e){var t="",i="",o="",s="",a="",l=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(l)?this.imageXPath.image:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.image,this.valueAttribute)),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(l)?this.imageXPath.iconImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.iconImage,this.valueAttribute)),""!=this.imageXPath.selectedImage&&(o=this.imageXPath.selectedImage.match(l)?this.imageXPath.selectedImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.selectedImage,this.valueAttribute)),""!=this.imageXPath.expandedImage&&(s=this.imageXPath.expandedImage.match(l)?this.imageXPath.expandedImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.expandedImage,this.valueAttribute)),""!=this.imageXPath.leafImage&&(a=this.imageXPath.leafImage.match(l)?this.imageXPath.leafImage:WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.leafImage,this.valueAttribute)),""!=a&&1==e.isLeaf()&&(t=a),""!=i&&(t=i,o=i,s=i),""==o&&(o=t),""==s&&(s=t),e.image=t,e.selectedImage=o,e.expandedImage=s,e.imageTitle=this.imageXPath.imageTitle&&WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.imageTitle,this.valueAttribute);for(var h=0;h<e.childNodes.length;h++)this.parseImage(e.childNodes[h])},h.prototype.parseImageInstance=function(e){var t="",i="",o="",s="",a="",l=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(l)?this.imageXPath.image:WebSquare.xml.getValue(e.element,this.imageXPath.image).wq_trim()||""),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(l)?this.imageXPath.iconImage:WebSquare.xml.getValue(e.element,this.imageXPath.iconImage).wq_trim()||""),""!=this.imageXPath.selectedImage&&(o=this.imageXPath.selectedImage.match(l)?this.imageXPath.selectedImage:WebSquare.xml.getValue(e.element,this.imageXPath.selectedImage).wq_trim()||""),""!=this.imageXPath.expandedImage&&(s=this.imageXPath.expandedImage.match(l)?this.imageXPath.expandedImage:WebSquare.xml.getValue(e.element,this.imageXPath.expandedImage).wq_trim()||""),""!=this.imageXPath.leafImage&&(a=this.imageXPath.leafImage.match(l)?this.imageXPath.leafImage:WebSquare.xml.getValue(e.element,this.imageXPath.leafImage).wq_trim()||""),""!=a&&1==e.isLeaf()&&(t=a),""!=i&&(t=i,o=i,s=i),""==o&&(o=t),""==s&&(s=t),e.image=t,e.selectedImage=o,e.expandedImage=s,e.imageTitle=this.imageXPath.imageTitle&&WebSquare.xml.getValue(e.element,this.imageXPath.imageTitle);for(var h=0;h<e.childNodes.length;h++)this.parseImageInstance(e.childNodes[h])},h.prototype.parseDataListImage=function(e){var t="",i="",o="",s="",a="",l=/\.[a-zA-Z][a-zA-Z][a-zA-Z][\s]*$/;""!=this.imageXPath.image&&(t=this.imageXPath.image.match(l)?this.imageXPath.image:e.element?e.element[this.imageXPath.image].wq_trim():""),""!=this.imageXPath.iconImage&&(i=this.imageXPath.iconImage.match(l)?this.imageXPath.iconImage:e.element?e.element[this.imageXPath.iconImage].wq_trim():""),""!=this.imageXPath.selectedImage&&(o=this.imageXPath.selectedImage.match(l)?this.imageXPath.selectedImage:e.element?e.element[this.imageXPath.selectedImage].wq_trim():""),""!=this.imageXPath.expandedImage&&(s=this.imageXPath.expandedImage.match(l)?this.imageXPath.expandedImage:e.element?e.element[this.imageXPath.expandedImage].wq_trim():""),""!=this.imageXPath.leafImage&&(a=this.imageXPath.leafImage.match(l)?this.imageXPath.leafImage:e.element?e.element[this.imageXPath.leafImage].wq_trim():""),""!=a&&1==e.isLeaf()&&(t=a),""!=i&&(t=i,o=i,s=i),""==o&&(o=t),""==s&&(s=t),e.image=t,e.selectedImage=o,e.expandedImage=s,e.imageTitle=this.imageXPath.imageTitle&&WebSquare.jsonUtil.getValue(e.element._element,this.imageXPath.imageTitle,this.valueAttribute)
;for(var h=0;h<e.childNodes.length;h++)this.parseDataListImage(e.childNodes[h])},h.prototype.parseListToTree=function(e){for(var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0),i=WebSquare.xmljs.xml2json(t).E[0],o=0;o<e.length;o++)e[o]._element.parent=i;var s=i,a=0;this.dataType="list";for(o=0;o<e.length;o++){s=new WebSquare.Elem(s);var l=e[o],h=parseInt(WebSquare.jsonUtil.getValue(l._element,this.xpath.depth,this.valueAttribute))||0;a=parseInt(WebSquare.jsonUtil.getValue(s._element,this.xpath.depth,this.valueAttribute))||0;if(0===h&&0!==a&&(l.setNodeValue(this.xpath.depth,a),h=a),a<h)l._element.parent=s._element,l=s.appendChild(l._element);else if(a==h&&0==o)l._element.parent=s._element,l=s.appendChild(l._element);else if(a==h){l._element.parent=s.getParentNode()._element,l=s.getParentNode().appendChild(l._element)}else if(a>h){s=s.getParentNode();for(var n=0;n<a-h;n++)null!=s._element.parent&&(s=s.getParentNode());s.element&&(s=s._element),l._element.parent=s._element,l=s.appendChild(l._element)}s=l}return new WebSquare.Elem(i)},h.prototype.parseListToTreeInstance=function(e){var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0),i=t.documentElement,o=0;this.dataType="list";for(var s=0;s<e.length;s++){var a=e[s].cloneNode(!0),l=parseInt(WebSquare.xml.getValue(a,this.xpath.depth))||0;o=parseInt(WebSquare.xml.getValue(i,this.xpath.depth))||0;if(0===l&&0!==o&&(WebSquare.xml.setValue(a,this.xpath.depth,o),l=o),o<l)a=WebSquare.xml.appendChild(i,a),o=l;else if(o==l&&0==s)a=WebSquare.xml.appendChild(i,a);else if(o==l){var h=i.parentNode;a=WebSquare.xml.appendChild(h,a)}else if(o>l){i=i.parentNode;for(var n=0;n<o-l;n++)null!=i.parentNode&&(i=i.parentNode);i.documentElement&&(i=i.documentElement),a=WebSquare.xml.appendChild(i,a)}i=a}return t.documentElement},h.prototype.parseRecursiveToTree=function(e){this.dataType="recursive";var t=WebSquare.xml.parse('<Treeview xmlns:w2="http://www.inswave.com/websquare" />',!0);if(e[0]instanceof WebSquare.Elem){for(var i=new WebSquare.Elem(WebSquare.xmljs.xml2json(t).E[0]),o=0;o<e.length;o++){var a=null;a=e[o],i.appendChild(a._element)}return i}for(o=0;o<e.length;o++){a=null;a=s.D.isOpera()?WebSquare.xml.parse(e[o]).firstChild:e[o].cloneNode(!0),WebSquare.xml.appendChild(t.documentElement,a)}return t.documentElement},h.prototype.parseTreeToList=function(){var e=this.xpath.nodeset;if(e.indexOf("/")>-1){var t=e.split("/");e=t[t.length-2]}e&&""!=e||(e="Treeview");var i=WebSquare.xml.parse("<"+e+' xmlns:w2="http://www.inswave.com/websquare" />',!0),o=i.documentElement,s=this.getNodeIterator({type:"dfs"});for(s.next();s.next();){var a=s.getNode();o.appendChild(a.element)}return i.documentElement},h.prototype.getNodeIterator=function(e){return e=o.x.extend({rootNode:null},e||{}),new l.nodeIterator(e.rootNode||this.rootNode,e)},h.prototype.size=function(){return this.nodeCount},h.prototype.findNodeByValue=function(e){for(var t=null,i=this.getNodeIterator(),o=0;i.next();){var s=i.getNode();if(!s.parentNode||1!=s.depth&&!0!==s.parentNode._isExpanded||o++,s.value==e){t=s;break}}return t&&(t._nodePosition=o),i=null,t},h.prototype.findNodeByIndex=function(e){var t=this.hash_index_node[e];return t||null},h.prototype.IterateFindNodeByIndex=function(e){for(var t=null,i=this.getNodeIterator(),o=0;i.next();){var s=i.getNode();if(!s.parentNode||1!=s.depth&&!0!==s.parentNode._isExpanded||o++,s.index==e){t=s;break}}return t&&(t._nodePosition=o),i=null,t},h.prototype.setRender=function(e,t){e.rendered=t;for(var i=0;i<e.childNodes.length;i++)this.setRender(e.childNodes[i],t)},h.prototype.getCloneNode=function(e){var t={};return t.checkboxDisabled=e.checkboxDisabled,t.checked=e.checked,t.folder=e.folder,t.image=e.image,t.imageTitle=e.imageTitle,t.rendered=e.rendered,t.id=e.id,t.index=e.index,t.value=e.value,t.label=e.label,t.labelStyle=e.labelStyle,t},h.prototype.getCloneNodeElemnt=function(e){var t={};return t.depth=e.depth,t.label=e.label,
t.value=e.value,t.rowStatus=e.rowStatus,t},h.prototype.clearNode=function(e){e.element=null,e.parentNode=null,e.childNodes=[],delete this.hash_index_node[e.index]},h.prototype.changeNodeIndex=function(e,t){var i=this.hash_index_node[e];i.index=t,delete this.hash_index_node[e],this.hash_index_node[t]=i,this.changeDomIndex("node",e,t,!0),this.changeDomIndex("checkbox",e,t),this.changeDomIndex("label",e,t),i.checkboxDom&&(i.checkboxDom=null,delete i.checkboxDom)},h.prototype.changeDomIndex=function(e,t,i,o){var a=document.getElementById(this.treeview.id+"_"+e+"_"+t);if(null!=a&&(a.setAttribute("id",this.treeview.id+"_"+e+"_"+i),o)){var l=s.D.getDataPrefix("index");a.setAttribute(l,i)}},h.prototype.getLastChildIndex=function(e){var t=this.findNodeByIndex(e),i=e;if(t.hasChild()){i=this.size();for(var o=t;!o.isRoot()&&o.depthIndex==o.parentNode.childNodes.length;)o=o.parentNode;o.isRoot()||o.depthIndex==o.parentNode.childNodes.length||(i=o.parentNode.childNodes[o.depthIndex].index-1)}return i};var n=i(1656),d=i(2085),r=i(1960),c=i(6615),p=function(e,t,i){c.s.call(this,e,t,i)};o.x.extend(p.prototype,c.s.prototype),p.prototype.defaultOptions={pluginType:"uiplugin.treeview",pluginName:"treeview",renderType:"virtual",userEvents:["onclick","ondblclick","onchange","onrightbuttonclick","ondrop","oncheckboxclick","onlabelclick","onlabelover","ontoggleclick","onviewchange","oneditend"],toggleEvent:"ondblclick",useConfig:!0,hierarchy:!1,refreshCheckboxModel:!1,refreshCheckboxDisableModel:!1,displayMode:"0",delimiter:"\t",folderOpenToggleImage:o.x._resourceURI+"uiplugin/treeview/images/plus.png",folderCloseToggleImage:o.x._resourceURI+"uiplugin/treeview/images/minus.png",leafToggleImage:o.x._resourceURI+"uiplugin/treeview/images/middle.gif",lastToggleImage:o.x._resourceURI+"uiplugin/treeview/images/last.gif",middleToggleImage:o.x._resourceURI+"uiplugin/treeview/images/middle.gif",labelclass:"",labelonClickClass:"treeview_select_node",labelForCheckbox:!1,title:"",escape:!0,rowHeight:20,useDrag:!1,accordion:!1,dynamicAppend:!1,dataType:"recursive",lineShow:!0,alwaysDraw:!1,showTreeDepth:0,showCheckbox:!1,trueValue:"true",falseValue:"false",checkAllChildNodes:!1,checkboxDisabled:"",checkboxDisabledTrueValue:"true",checkboxDisabledFalseValue:"false",checkboxDisabledAll:!1,scrollFix:!1,tooltipDisplay:!1,tooltipShowAlways:!1,tooltipStyle:"border:2px solid #7BAFE4; background-color:#ffffff;cursor:default;",tooltipClass:"",tooltipTime:1,tooltipGroupClass:!0,redrawInterval:3,useHirarchySelect:!1},p.prototype.initialize=function(e){try{switch(this.inlineElement=!1,this.useDataCollection=!1,this.successBinding=!1,this.nativeScrollWidth=18,this.tooltip=null,this.timeShowTooltip=null,this.timeHideTooltip=null,this.tree=new h,this.tree.treeview=this,this.selectedInfo={groupDom:null,dom:null,node:null},this.resizeObj={width:0,height:0},this.tree.setData(this._getDataObj(e)),this._request=null,this._expandedNodes=[this.tree.rootNode],this._items=[],1==this.options.accordion&&(this.options.showTreeDepth=0),this._setExpandedLevel(),this._arrowDownPressed=!1,this._arrowUpPressed=!1,this._forceRedraw=!1,this.isMobile=s.D.isMobile(),this.touchDelta={x:0,y:0},this.options.checkAllChildNodes=this.options.hierarchy,this.options.displayMode){case"0":case"1":case"2":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;default:this.options.displayMode="0"}this.tree.setDisplayMode(this.options.displayMode,this.options.delimiter),this.editModeComp=null,this.options=WebSquare.cssManager.styleToClass(this.id,this.options),1==this.options.showCheckbox&&(1==s.D.isOpera()?this.checkboxStyle="left:-1px;top:-1px":this.checkboxStyle="left:0px;top:0px"),this.options.useHirarchySelect&&(this.selectedInfoStack=[]),this._extraRow=0,this._bExtraRowRedraw=!1,this._epsilon=2,this._initMaxRowHeight()}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.finalize=function(){
null!=this.editModeComp&&WebSquare.idCache[this.editModeComp.uuid]&&this.editModeComp.remove(),this._request=null;for(var e=0,t=this._items.length;e<t;e++)this._items[e]=null;this._items=null;for(e=0,t=this.dom.length;e<t;e++)this.dom[e]=null;for(var i in this.dom=null,this.selectedInfo)this.selectedInfo.hasOwnProperty(i)&&(this.selectedInfo[i]=null);this.selectedInfo=null;for(e=0,t=this.tree.size();e<t;e++)this.tree.hash_index_node[e]=null;for(var i in this.tree)this.tree.hasOwnProperty(i)&&(this.tree[i]=null);this.tree=null,c.s.removeCheckResize(this.uuid),c.s.prototype.finalize.call(this)},p.prototype._getData=function(e,t,i){try{for(var o=[],s=0,a=e.length;s<a;s++){var l=[];l=this.tree.hash_index_node[e[s].parent].childNodes.slice(0),o.push({parent:e[s].parent,items:l.splice(e[s].offset,e[s].limit)})}this._setData(t,i,o)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._setData=function(e,t,i){for(var o=[],s=0,a=i.length;s<a;s++){for(var l=i[s],h=-1,n=0,d=o.length;n<d;n++)if(o[n].index===l.parent){h=n;break}o=h>-1?o.slice(0,h+1).concat(l.items).concat(o.slice(h+1)):l.items.concat(o)}this._items=o,this._redraw(o,e,t)},p.prototype._expandNode=function(e){e.expandedNodes||(e.expandedNodes=[]);var t=e.parentNode;t&&!e.isExpanded()&&(t.expandedNodes.push(e),t._isExpanded=!0)},p.prototype._collapseNode=function(e){var t=e.parentNode;if(t&&e.isExpanded()){for(var i=-1,o=0,s=t.expandedNodes.length;o<s;o++){var a=t.expandedNodes[o];if(e.index===a.index){i=o;break}}t.expandedNodes.splice(i,1),t._isExpanded=!1}},p.prototype.redraw=function(e,t){var i=this.render.clientHeight||parseInt(this.render.style.height,10)||parseInt(WebSquare.style.getComputedStyle(this.render,"height"),10),o=Math.floor(i/this.options.rowHeight)+this._extraRow,s=Math.ceil(this.getElementById(this.id+"_scrollY_div").scrollTop/this.options.rowHeight),a=this._buildTree(s,o);this._getData(a,e,t),this._items.length>0&&(this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight})},p.prototype._buildTree=function(e,t){var i=[];this._sortAllExpandedNodes(this._expandedNodes),this._calculateExpandedNodes(this._expandedNodes,-1);var o=function(s,a){for(var l=0,h=s.length;l<h;l++){var n=s[l];if(f=e,m=e+t,g=n._start,b=n._end,g<f&&b<f||g>m&&b>m)e>n._end&&a&&(a.offset-=n._end-n._start+1);else{var d=Math.max(e,n._start),r=Math.min(e+t-1,n._end),c=Math.max(0,Math.min(r-d+1,t));if(a&&(a.limit-=c,e>n._start)){var p=n._end-n._start+1-c;p>0&&(a.offset-=p)}var u={parent:n.index,offset:e>n._start?e-n._start:0,limit:Math.min(c,t)};i.push(u),o(n.expandedNodes,u)}}var f,m,g,b};return o(this._expandedNodes),i},p.prototype._iterateAllExpandedNodes=function(e,t){try{for(var i=0,o=e.length;i<o;i++)t(e[i]),this._iterateAllExpandedNodes(e[i].expandedNodes,t)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._findExpandedNodeByIndex=function(e){var t=null;return this._iterateAllExpandedNodes(this._expandedNodes,(function(i){i.index===e&&(t=i)})),t},p.prototype._sortAllExpandedNodes=function(e){try{e.sort((function(e,t){return e.depthIndex-t.depthIndex}));for(var t=0;t<e.length;t++)this._sortAllExpandedNodes(e[t].expandedNodes)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._calculateExpandedNodes=function(e,t){try{for(var i=0;i<e.length;i++){var o,s=e[i],a=e[i-1];o=a?a._end+1+(s.depthIndex-a.depthIndex):t+s.depthIndex+1,s._start=o;var l=s.childNodes.length;this._iterateAllExpandedNodes(s.expandedNodes,(function(e){l+=e.childNodes.length})),s._end=s._start+l-1,this._calculateExpandedNodes(s.expandedNodes,s._start)}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._setExpandedLevel=function(){try{var e=0,t=null;if(1==this.options.alwaysDraw)for(e=0;e<this.tree.size();e++)t=this.tree.hash_index_node[e],this._expandNode(t);else for(e=0;e<this.tree.size();e++)(t=this.tree.hash_index_node[e]).depth<this.options.showTreeDepth&&this._expandNode(t)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.toHTML=function(){try{
var e=[],t=this.nativeScrollWidth+"px",i=""==this.options.style?"":"style='"+this.options.style+"'",o="style='right:"+t+";'",s="style='right:"+t+"; height:"+t+";'",a="style='width:"+t+";'";return e.push("<div id='"+this.id+"' tabindex='0'"+i+" class='w2treeview_virtual "+this.options.className+"'>"),e.push("  <div id='"+this.id+"_main_div' "+o+" class='w2treeview_virtual_main_div' >"),e.push("  </div>"),e.push("  <div id='"+this.id+"_scrollX_div' "+s+" class='w2treeview_virtual_scrollX_div'>"),e.push("      <div id='"+this.id+"_scrollX_scrollbar' style='width:1px; height:1px; visibility:hidden;'></div>"),e.push("  </div>"),e.push("  <div id='"+this.id+"_scrollY_div' "+a+" class='w2treeview_virtual_scrollY_div' >"),e.push("      <div id='"+this.id+"_scrollY_scrollbar' style='width:1px; height:1px; visibility:hidden;'></div>"),e.push("  </div>"),e.push("</div>"),e.join("")}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.setAction=function(){try{if(this.dom[this.id+"_main_div"]=document.getElementById(this.id+"_main_div"),this.dom[this.id+"_scrollX_div"]=document.getElementById(this.id+"_scrollX_div"),this.dom[this.id+"_scrollX_scrollbar"]=document.getElementById(this.id+"_scrollX_scrollbar"),this.dom[this.id+"_scrollY_div"]=document.getElementById(this.id+"_scrollY_div"),this.dom[this.id+"_scrollY_scrollbar"]=document.getElementById(this.id+"_scrollY_scrollbar"),this.tree.rootNode?this.redraw(!0):this._updateScroll(),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblclickEvent)),this.isMobile||(this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),this.event.addListener2(this.dom[this.id+"_main_div"],"onmousewheel",this.handleMouseWheelEvent,this),this.event.addListener2(this.dom[this.id+"_main_div"],"onscroll",this.fixScrollTop,this)),this.event.addListener(this.render,"onselectstart",(function(e){r.B.stopEvent(e)})),this.event.addListener(this.render,"oncontextmenu",this.event.bindAsEventListener(this,this.handleContextmenuEvent)),this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.activateDrag)),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener2(this.dom[this.id+"_scrollX_div"],"onscroll",this.handleScrollXEvent,this),this.event.addListener2(this.dom[this.id+"_scrollY_div"],"onscroll",this.handleScrollYEvent,this),this.refreshStop=!1,this.useDataCollection)this.modelControl.getDataComp().bind("onbeforecelldatachange",this.event.bindAsEventListener(this,this.notifyValidCheck));c.s.addCheckResize(this.uuid,"checkResize")}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._redraw=function(e,t,i){try{for(var o=[],s=0,a=e.length;s<a;s++)o.push(this.nodeToHTML(e[s]));if(document.getElementById(this.id+"_main_div").innerHTML=o.join(""),1==t){var l=0;this._forceRedraw=!0,this._iterateAllExpandedNodes(this._expandedNodes,(function(e){l+=e.childNodes.length})),this._updateScroll(l)}i&&i.call(this)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._getNativeScrollWidth=function(){var e=document.createElement("div");e.style="overflow-y:scroll; visibility:hidden; width:100px;",document.body.appendChild(e);var t=document.createElement("div");e.appendChild(t);var i=100-t.offsetWidth;return document.body.removeChild(e),i},p.prototype._updateScroll=function(e){
var t=this.getElementById(this.id+"_main_div"),i=this.getElementById(this.id+"_scrollY_div"),o=this.getElementById(this.id+"_scrollX_div"),s=this.getElementById(this.id+"_scrollY_scrollbar"),a=this.getElementById(this.id+"_scrollX_scrollbar"),l=t.clientWidth,h=t.scrollWidth,n=this._getVisibleInfo(),d=n.height,r=l<h,c=r?this.nativeScrollWidth:0,p=e>t.childNodes.length||d>=t.offsetHeight-c,u=0;if(p){var f=Math.floor((t.offsetHeight-d)/this._minRowHeight);if(this._extraRow<f&&(this._extraRow=f,!0!==this._bExtraRowRedraw))return this._bExtraRowRedraw=!0,this.redraw(!0);var m=Math.max(t.offsetHeight-d-c,0),g=Math.floor(m/this.options.rowHeight);(u=e-n.rowCount-g)<=0&&(u=0,p=!1)}this._bExtraRowRedraw=!1,i.style.visibility=p?"visible":"hidden",t.style.right=p?this.nativeScrollWidth+"px":0,o.style.visibility=r?"visible":"hidden",o.style.right=p?this.nativeScrollWidth+"px":0;var b=u*this.options.rowHeight+t.offsetHeight,x=p?h+this.nativeScrollWidth:h;s.style.height=b+"px",a.style.width=x+"px"},p.prototype.expandNode=function(e,t){try{var i=null;if(i="number"==typeof e?this.tree.findNodeByIndex(e):this.tree.findNodeByValue(e),this._expandNode(i),t)for(var o=0,s=i.childNodes.length;o<s;o++)this.expandNode(i.childNodes[o].index,t);this.redraw(!0)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.collapseNode=function(e,t){try{var i=null;if(i="number"==typeof e?this.tree.findNodeByIndex(e):this.tree.findNodeByValue(e),this._collapseNode(i),t)for(var o=0,s=i.childNodes.length;o<s;o++)this.collapseNode(i.childNodes[o].index,t);this.redraw(!0)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.findNodeByValue=function(e,t){try{var i=this.tree.findNodeByValue(e);if(!0===t&&i){var o=i._nodePosition*this.options.rowHeight,s=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight,a=this.dom[this.id+"_scrollY_div"].scrollTop;return s<o?(a+s<o||a>=o)&&(this.dom[this.id+"_scrollY_div"].scrollTop=o-s+parseInt(this.render.offsetHeight/2)):(a+s<o||a>=o)&&(this.dom[this.id+"_scrollY_div"].scrollTop=0),this.selectNode(e,null),this.getSelectedNode()}return i}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.findNodeByIndex=function(e,t){try{if(!0===t){if(!this.tree.findNodeByIndex(e))return;var i=this.tree.IterateFindNodeByIndex(e)._nodePosition*this.options.rowHeight,o=WebSquare.style.getAbsoluteTop(this.render)+this.render.offsetHeight,s=this.dom[this.id+"_scrollY_div"].scrollTop;return o<i?(s+o<i||s>=i)&&(this.dom[this.id+"_scrollY_div"].scrollTop=i-o+parseInt(this.render.offsetHeight/2)):(s+o<i||s>=i)&&(this.dom[this.id+"_scrollY_div"].scrollTop=0),this.selectNode(null,e),this.getSelectedNode()}return this.tree.findNodeByIndex(e)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.toggleChild=function(e,t,i){try{var o;if(null==t&&(t=-1),null!=e&&(o=this.tree.findNodeByValue(e))&&(t=o.index),o=this.tree.findNodeByIndex(t),1==this.options.accordion)for(var s=o._ancestor,a=1,l=this.tree.size();a<l;a++)this.tree.hash_index_node[a]._ancestor!=s&&this._collapseNode(this.tree.hash_index_node[a]);switch(i){case!0:this._expandNode(o);break;case!1:this._collapseNode(o);break;default:o.isExpanded()?this._collapseNode(o):this._expandNode(o)}this.redraw(!0)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.appendData=function(e,t,i){try{if(0==this.options.dynamicAppend&&$l("treeview를 동적으로 처리하는 경우에는  dynamicAppend='true'로 설정하는 것을 권장합니다.["+this.id+"]"),void 0===e||null==e||!t)return;i=void 0!==i&&i;var o=this.tree.findNodeByIndex(e);if(!i&&o.childNodes&&o.childNodes[0]&&o.childNodes[0].rendered)return;var s=null;"recursive"==this.options.dataType?s=this.tree.parseRecursiveToTree(t):"listed"==this.options.dataType&&(s=this.tree.parseListToTree(t)),this.tree.appendXML(s,e),0==e?(o.hasChild(),this.redraw()):o.childNodes.length>0&&(o.childNodes[0].rendered=!1,this.toggleChild(null,o.index,!0))}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.spanAll=function(e){try{
if(1==this.options.accordion)return void $l("treeview의 accordion 모드에서는 spanAll API를 지원하지 않습니다.["+this.id+"]");var t=this.tree.size();if(1==e)for(var i=0;i<t;i++)this._expandNode(this.tree.hash_index_node[i]);else if(0==e)for(i=t-1;i>=0;i--)this.tree.hash_index_node[i].expandedNodes=[];this.redraw(!0)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.spanNode=function(e,t,i){try{return null==e&&null==t&&null==i?void 0:null==t&&null==i&&"object"==typeof e?this._spanNode(e):null==i&&"object"==typeof e&&"boolean"==typeof t?this._spanNode(e,t):this._spanNode({index:e,applyChildNodes:i},t)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._spanNode=function(e,t){try{if(1==this.options.accordion)return void $l("treeview의 accordion 모드에서는 spanNode API를 지원하지 않습니다.["+this.id+"]");var i=e.index,o=e.depth,s=e.applyChildNodes;if(0==i||i){var a=(r=this.findNodeByIndex(i)).childNodes;if(1==t){if(1==s)for(var l=0;l<a.length;l++)a[l].childNodes.length>0&&this.spanNode(a[l].index,t,s)}else if(0==t&&1==s)for(l=a.length-1;l>=0;l--)a[l].childNodes.length>0&&this.spanNode(a[l].index,t,s);this.toggleChild(null,i,t)}else if(0==o||o)for(var h=0,n=this.tree.nodeCount;h<n;h++){var r;if((r=this.tree.hash_index_node[h]).depth===o){if("boolean"==typeof s)for(var c=r.childNodes,p=(l=0,c.length);l<p;l++)c[l].childNodes.length>0&&this.spanNode(c[l].index,t,s);this.toggleChild(null,r.index,t)}}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.selectNode=function(e,t,i,o,a){try{"object"==typeof a&&null!=a||(a={});i=void 0===i||i;var l=s.D.getBoolean(this.options.useHirarchySelect),h=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,n=null;if(null!=e?n=this.tree.findNodeByValue(e):null!=t&&(n=this.tree.findNodeByIndex(t)),this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.style.backgroundColor=this.originalBackgroundColor,this.selectedInfo.dom.style.color=this.originalColor,""!=this.selectedInfo.node.image)){var c=this.selectedInfo.node,p=document.getElementById(this.id+"_icon_"+c.index),u=c.isExpanded()?c.expandedImage:c.image;p&&(p.style="background-image:url("+u+")")}if(l&&this.selectedInfoStack.length>0){for(var f=0;f<this.selectedInfoStack.length;f++){var m=this.selectedInfoStack[f];m.dom&&(this.removeClass(m.dom,this.options.labelonClickClass),m.dom.style.backgroundColor=m.org.background,m.dom.style.color=m.org.color)}this.selectedInfoStack=[]}if(null!=h&&null!=n?h.index!=n.index&&r.B.fireEvent(this,"onchange",h,n):(null==h&&null!=n||null!=h&&null==n)&&r.B.fireEvent(this,"onchange",h,n),this.selectedInfo.node=n,null!=this.selectedInfo.node&&i){for(var g=this.selectedInfo.node.parentNode,b=[];g;){t=g.index;b.push(t),g=g.parentNode}for(var f in b.reverse(),b)this._expandNode(this.findNodeByIndex(b[f]));this.redraw(!0)}if(this.selectedInfo.dom=document.getElementById(this.id+"_label_"+this.selectedInfo.node.index),this.selectedInfo.groupDom=document.getElementById(this.id+"_node_"+this.selectedInfo.node.index),this.addClass(this.selectedInfo.dom,this.options.labelonClickClass),""!=this.selectedInfo.node.image&&""!=this.selectedInfo.node.selectedImage){p=document.getElementById(this.id+"_icon_"+this.selectedInfo.node.index);this.originalIconImage=p.style,p.style="background-image:url("+this.selectedInfo.node.selectedImage+")"}if(this.selectedInfo.dom){if(this.originalBackgroundColor=this.selectedInfo.dom.style.backgroundColor,this.originalColor=this.selectedInfo.dom.style.color,l){for(g=this.selectedInfo.node;g;){var x=document.getElementById(this.id+"_label_"+g.index);this.selectedInfoStack.push({node:g,groupDom:document.getElementById(this.id+"_node_"+g.index),dom:x,org:{background:x?x.style.backgroundColor:null,color:x?x.style.color:null}}),this.selectedInfoStack[this.selectedInfoStack.length-1].dom&&(this.addClass(this.selectedInfoStack[this.selectedInfoStack.length-1].dom,this.options.labelonClickClass),
this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.backgroundColor="",this.selectedInfoStack[this.selectedInfoStack.length-1].dom.style.color=""),g=g.parentNode}this.selectedInfoStack.reverse()}this.selectedInfo.dom.style.backgroundColor="",this.selectedInfo.dom.style.color=""}if(!0!==o){if(this.options.scrollFix)this.render.focus();else if(this.selectedInfo.groupDom&&(this.selectedInfo.groupDom.setAttribute("tabindex",0),this.selectedInfo.groupDom.focus(),this.selectedInfo.groupDom.setAttribute("tabindex",-1),!0!==a.skipScrollTop)){var v=this.getElementById(this.id+"_main_div"),y=this.selectedInfo.groupDom.offsetTop+this.selectedInfo.groupDom.offsetHeight-v.offsetHeight;y>0&&(this.dom[this.id+"_scrollY_div"].scrollTop+=Math.ceil(y/this.options.rowHeight)*this.options.rowHeight)}if(this.useDataCollection&&this.successBinding){var _=this.modelControl.getDataComp();if(null!=this.selectedInfo.node){for(var k in _.refCompHash){var N=_.refCompHash[k];null!=N&&WebSquare.idCache[N.uuid]&&"input"==N.options.pluginName&&N.setValue(N.getValue())}_.setRowPosition(this.selectedInfo.node.index-1)}else _.setRowPosition(null)}}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.selectNode1=function(e,t,i,o,s){try{if(null!=this.selectedInfo.node){var a=this.tree.getCloneNode(this.selectedInfo.node),l=a.index;if(this.selectNode(e,t,i,o,s),null!=this.selectedInfo.node)if(l!=this.selectedInfo.node.index){var h={oldNode:a,newNode:this.tree.getCloneNode(this.selectedInfo.node)};r.B.fireEvent(this,"onviewchange",h)}}else if(this.selectNode(e,t,i,o,s),null!=this.selectedInfo.node){h={oldNode:{},newNode:this.tree.getCloneNode(this.selectedInfo.node)};r.B.fireEvent(this,"onviewchange",h)}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.isOpen=function(e){try{if(e>=this.tree.size()||e<1)return;return this.findNodeByIndex(e).isExpanded()}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getSelectedNode=function(){try{return this.selectedInfo?this.selectedInfo.node:null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getSelectedDom=function(){try{return this.selectedInfo?this.selectedInfo.dom:null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getSelectedLabel=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.label:""}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getSelectedValue=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.value:""}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getSelectedIndex=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.index:""}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getSelectedElement=function(){try{return this.selectedInfo&&this.selectedInfo.node?this.selectedInfo.node.element:null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.setLabelStyle=function(e,t,i,o){var s;"object"==typeof e&&"number"==typeof e.index?s=e:"number"==typeof e?s=this.tree.findNodeByIndex(e):"string"==typeof e&&(s=this.tree.findNodeByValue(e)),this._setLabelStyle(s,t,i,o)},p.prototype._setLabelStyle=function(e,t,i,o){if(null!=e){for(t in null==e.labelStyle&&(e.labelStyle={}),e.labelStyleStr="",e.labelStyle[t]=i,this.originalBackgroundColor=e.labelStyle["background-color"]||this.originalBackgroundColor,this.originalColor=e.labelStyle.color||this.originalColor,e.labelStyle)e.labelStyleStr+=t+":"+e.labelStyle[t]+";";if(e.rendered){var s=document.getElementById(this.id+"_label_"+e.index);if(s){for(var a="",l=0,h=t.length;l<h;l++)"-"===t.charAt(l)?(a+=t.charAt(l+1).capitalize(),l++):a+=t.charAt(l);s.style[a]=i}}if(!0===o)for(l=0,h=e.childNodes.length;l<h;l++){var n=e.childNodes[l];this._setLabelStyle(n,t,i,o)}}},p.prototype.disableCheckboxByValue=function(e,t,i){try{var o=this.tree.findNodeByValue(e);o&&this.disableCheckbox(o,t,i)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.setLabelByIndex=function(e,t,i){
this.setLabel(this.tree.findNodeByIndex(e),t,i)},p.prototype.setLabelByValue=function(e,t,i){this.setLabel(this.tree.findNodeByValue(e),t,i)},p.prototype.setLabel=function(e,t,i){try{if(e){var o=this.refreshStop;if(this.refreshStop=!0,this.useDataCollection||(this.modelControl.useItemset&&WebSquare.ModelUtil.setInstanceValue(e.xpath+"/"+this.tree.xpath.label,t),WebSquare.xml.setValue(e.element,"label",t)),"function"==typeof this.tree.customFormatter){var s=this.tree.getCloneNode(e);t=this.tree.customFormatter.call(this,t,t,s)}if(e.label=t,e.orgLabel=t,e.rendered){var a=document.getElementById(this.id+"_label_"+e.index);a&&(a.innerHTML=t)}if(this.refreshStop=o,this.useDataCollection){var l=this.modelControl.getDataComp();null!=l&&l.setCellData(e.index-1,this.tree.dataPath.label,t,null,i)}}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.checkNode=function(e,t,i,o,s){try{var a=this.tree.findNodeByIndex(e);if(a.checked=t,1==this.options.refreshCheckboxModel){if(this.stopRefresh(!0),this.useDataCollection&&this.tree.checkbox.colID){var l=this.modelControl.getDataComp(),h=t?this.options.trueValue:this.options.falseValue;null!=l&&l.setCellData(e-1,this.tree.checkbox.colID,h,null,s)}else 1==t?a.checkboxXPath&&null!=WebSquare.ModelUtil.findInstanceNode(a.checkboxXPath)&&WebSquare.ModelUtil.setInstanceValue(a.checkboxXPath,this.options.trueValue):a.checkboxXPath&&null!=WebSquare.ModelUtil.findInstanceNode(a.checkboxXPath)&&WebSquare.ModelUtil.setInstanceValue(a.checkboxXPath,this.options.falseValue);this.stopRefresh(!1)}if(!1!==i&&(1==i||1==this.options.hierarchy||1==this.options.checkAllChildNodes))for(var n=0,r=a.childNodes.length;n<r;n++){var c=a.childNodes[n];this.checkNode(c.index,t,!0,!1)}if(1==this.options.hierarchy&&this.partialSelection(a),!1!==o&&a.parentNode.parentNode&&1==this.options.hierarchy){var p=!0;for(n=0,r=a.parentNode.childNodes.length;n<r;n++){if(1!=(c=a.parentNode.childNodes[n]).checked){p=!1;break}}1==p?this.checkNode(a.parentNode.index,!0,!1):this.checkNode(a.parentNode.index,!1,!1)}this.redraw(!1)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.checkByIndex=function(e,t,i){try{var o=this.tree.findNodeByIndex(e);if(!o)return;this.checkNode(o.index,t,i)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.checkByValue=function(e,t,i){try{var o=this.tree.findNodeByValue(e);if(!o)return;this.checkNode(o.index,t,i)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getCheckedNodeByType=function(e,t){try{"object"==typeof e&&null!=e||(e={});for(var i=[],o=this.tree.getNodeIterator({type:"bfs"});o.next();){var s=o.getNode();(1==s.checked||e.hierarchy&&1==s.partial&&!s.isRoot())&&(e.excludeRoot&&!s.isRoot()||!e.excludeRoot)&&i.push(s[t])}return i}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getCheckedValues=function(e){return this.getCheckedNodeByType(e,"value")},p.prototype.getCheckedLabels=function(e){return this.getCheckedNodeByType(e,"label")},p.prototype.getCheckedIndexes=function(e){return this.getCheckedNodeByType(e,"index")},p.prototype.getCheckedNodes=function(e){return this.getCheckedNodeByType(e,"element")},p.prototype.disableCheckbox=function(e,t,i){try{if(t=s.D.getBoolean(t),e.checkboxDisabled=t,1==this.options.refreshCheckboxDisableModel&&(this.stopRefresh(!0),1==t?null!=WebSquare.ModelUtil.findInstanceNode(e.checkboxDisableXPath)&&WebSquare.ModelUtil.setInstanceValue(e.checkboxDisableXPath,this.options.checkboxDisabledTrueValue):null!=WebSquare.ModelUtil.findInstanceNode(e.checkboxDisableXPath)&&WebSquare.ModelUtil.setInstanceValue(e.checkboxDisableXPath,this.options.checkboxDisabledFalseValue),this.stopRefresh(!1)),!0===i||!1===i)for(var o=0,a=e.childNodes.length;o<a;o++){var l=e.childNodes[o];this.disableCheckbox(l,t,i)}this.redraw(!1)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.partialSelection=function(e){try{var t=0,i=!1;if(0==e.childNodes.length)return;for(var o=0,s=e.childNodes.length;o<s;o++){var a=e.childNodes[o]
;1==a.checked?t++:1==a.partial&&(i=!0)}1==i||0<t&&t<e.childNodes.length?(e.partial=!0,this.addClass(e.checkboxDom,"treeview_partialselect")):(e.partial=!1,this.removeClass(e.checkboxDom,"treeview_partialselect"))}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getParentValue=function(e){try{var t="",i=this.tree.findNodeByValue(e);return i&&i.parentNode&&(t=i.parentNode.value),t}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getChildData=function(e){try{for(var t=this.tree.findNodeByValue(e),i=[],o=0,s=t.childNodes.length;o<s;o++)1==this.options.dynamicAppend||this.useDataCollection?i.push(t.childNodes[o].element):i.push(WebSquare.ModelUtil.findInstanceNode(t.childNodes[o].xpath));return i}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.setCustomFormatter=function(e){if("function"==typeof e){for(var t=this.tree.getNodeIterator();t.next();){var i=t.getNode();if(!i.isRoot()){var o=this.tree.getCloneNode(i),s=e.call(this,i.orgLabel,i.label,o)||i.label;if(i.label=s,i.rendered){var a=document.getElementById(this.id+"_label_"+i.index);a&&(a.firstChild.nodeValue=i.label)}}}t=null,this.tree.customFormatter=e}},p.prototype.appendNode=function(e,t){try{if(0==this.options.dynamicAppend&&$l("treeview를 동적으로 처리하는 경우에는  dynamicAppend='true'로 설정하는 것을 권장합니다.["+this.id+"]"),1==this.options.dynamicAppend){var i=e.childNodes?e.childNodes.length:0,o=t.parentNode,s=this.tree.parseNodeByNode(t,e.depth+1,i,e);e.appendChild(s),o.removeChild(t);for(var a=0,l=o.expandedNodes.length;a<l;a++){var h=o.expandedNodes[a];if(t.index===h.index){o.expandedNodes.splice(a,1);break}}for(a=0,l=e.childNodes.length;a<l;a++)this.tree.setRender(e.childNodes[a],!1);e.childNodes.length>0&&(e.childNodes[0].rendered=!1,e.expandedNodes.push(s),this.toggleChild(null,e.index,!0))}else e.appendChild(t),e.expandedNodes.push(t),this.toggleChild(null,e.index,!0)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.removeNode=function(e){try{if(!e)return;var t=e.parentNode;t&&(e.isExpanded()&&this._collapseNode(e),t.removeChild(e),this.redraw(!0))}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.removeNodeList=function(e){try{for(var t=0;t<e.length;t++)if(e[t]){var i=e[t].parentNode;i&&i.removeChild(e[t])}this.drawContents()}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.moveNode=function(e,t,i){try{if(!this.useDataCollection)return!1;if(e==t)return!1;if(e<t&&this.getLastChildIndex(e)>=t)return a.k.printLog("treeview moveNode : Invalid argument. [destIndex] must not be child of [srcIndex].["+this.id+"]"),!1;for(var o=this.modelControl.getDataComp(),s=e-1,l=t-1,h=this.findNodeByIndex(e),n=this.findNodeByIndex(t),r=this.getLastChildIndex(s+1)-1,c=[],p=this.tree.dataPath.depth,u=0,f=s;f<=r;f++){var m=o.getRowJSON(f);m[p]=i?Number(m[p])+(n.depth-h.depth+1):Number(m[p])+(n.depth-h.depth),"number"!==o.getColumnInfo(p).dataType&&(m[p]=m[p]+""),c.push(m),u++}this.stopRefresh(!0),o.removeRange(s,r),s<l&&(l+=s-r-1);var g=0;if(!i){var b=this.getLastChildIndex(t);g=b-t,t<=s&&b>=r&&(g-=u)}return o.insertJSON(l+1+g,c),this.stopRefresh(!1),this.refreshItemset(),this.selectNode(null,l+2+g),!0}catch(e){return d.w.printStackTrace(e,null,this),!1}},p.prototype.getLastChildIndex=function(e){try{var t=this.findNodeByIndex(e),i=e;if(t.hasChild()){i=this.tree.nodeCount-1;for(var o=t;!o.isRoot()&&o.depthIndex==o.parentNode.childNodes.length;)o=o.parentNode;o.isRoot()||o.depthIndex==o.parentNode.childNodes.length||(i=o.parentNode.childNodes[o.depthIndex].index-1)}return i}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.activateDrag=function(e){try{r.B.stopEvent(e);var t=s.D.getDataPrefix("index"),i=s.D.getDataPrefix("tdIndex");1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll();var o=this,a=this.event.getTargetIterator(e,this.render);if(a.element.id===this.id)return;for(var l=!1;a.next();)if((a.match("treeview_icon_open")||a.match("treeview_icon_close"))&&!0,a.match("treeview_virtual_label")&&!0,
(a.match("treeview_icon_navi")||a.match("w2treeview_icon_navi_img"))&&(l=!0),a.match("treeview_virtual_node")){var h=a.getElement().getAttribute(t);if(null==h){a.stop();break}if("onmousedown"==this.options.toggleButtonEvent){var n=this.tree.findNodeByIndex(h);if(l&&!n.isLeaf()){this.toggleChild(null,h);var c=!!(n.childNodes&&n.childNodes[0]&&n.childNodes[0].rendered);this.inlineElement?r.B.fireEvent(this,"ontoggleclick",null,h,c):r.B.fireEvent(this,"ontoggleclick",n.element,h,c)}}if(1==this.options.useDrag){var p=this.tree.hash_index_node[h].label;WebSquare.dragdrop.gDragManager.activate(e,a.getElement(),{id:this.id+"_drag",className:"w2treeview_drag",contents:p,delay:15,dropClass:"treeview_virtual_node",dragoverClass:"treeview_label",applyMousePosition:!0,onDrop:function(e,a,l,h,n,d,c){if(e){var p=null,u={},f=null,m=null,g=null;for(u=a?new WebSquare.targetIterator(a,o.render):o.event.getTargetIterator(c);u.next();){if(u.match("w2treeview_virtual")){var b=u.getElement().id;s.D.getComponentById(b)&&(p=s.D.getComponentById(b)),u.stop()}if(u.match("w2grid")&&(f=u.getElement().id,u.stop()),!m&&u.match(null,null,"td")){var x=u.getElement();m=parseInt(x.getAttribute(i),10)}}if(u=null,p&&!a&&(a=document.getElementById(p.id+"_node_0")),e&&a&&p){var v=e.getAttribute(t),y=a.getAttribute(t),_=o.tree.findNodeByIndex(v),k=p.tree.findNodeByIndex(y);r.B.fireEvent(p,"ondrop",_,k,o,p,c)}if(null!=f&&(g=(f=s.D.getComponentById(f)).getDataLength(),null!=m&&(g=f.rowIndex+parseInt(m/(f.oneRowDataLength+f.defaultColCnt)))),e&&f){v=parseInt(e.getAttribute(t),10)-1;if(o.useDataCollection)var N=o.modelControl.getDataComp();_=o.tree.findNodeByIndex(v+1);r.B.fireEvent(f,"ondropfromtree",{dataListId:N.id,fromRowIndex:v,toRowIndex:g,dragNode:_})}}},onDragover:function(e,i,a,l,h,n,d){if(e)if(i){for(var c=null,p=new WebSquare.targetIterator(i,o.render);p.next();)if(p.match("w2treeview")){var u=p.getElement().id;s.D.getComponentById(u)&&(c=s.D.getComponentById(u)),p.stop()}if(p=null,c){var f=e.getAttribute(t),m=i.getAttribute("id"),g=m.substring(m.lastIndexOf("_")+1,m.length),b=o.tree.findNodeByIndex(f),x=c.tree.findNodeByIndex(g);r.B.fireEvent(c,"ondragover",b,x,o,c,d)}}else r.B.fireEvent(o,"ondragleave",d)}})}a.stop()}a=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getNextNode=function(e){for(var t=null,i=e.index,o=0,s=this._items.length;o<s;o++)if(this._items[o].index==i){t=this._items[o+1];break}return t},p.prototype.getPreviousNode=function(e){for(var t=null,i=e.index,o=0,s=this._items.length;o<s;o++)if(this._items[o].index==i){t=this._items[o-1];break}return t},p.prototype.showTooltip=function(e,t,i){try{null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var o=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var a=n.v.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(a){var l=s.D.getGlobalFunction(a,o.scope_id),h=!0;if("function"==typeof l&&(h=l(o)),!h)return}}catch(e){d.w.printStackTrace(e)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2treeview_tooltip "+this.options.tooltipClass}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.options.tooltipGroupClass||this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i})),1e3*this.options.tooltipTime)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&this.tooltip.setStyle("display","none")})),1e3*this.options.tooltipTime)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.onPropertyChange=function(e,t){try{switch(e){
case"disabled":this.options.disabled=t,t?this.addClass(this.render,"w2treeview_disabled"):this.removeClass(this.render,"w2treeview_disabled")}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.setDisabled=function(e){e=s.D.getBoolean(e);var t=c.s.prototype.setDisabled.call(this,e);return this.disableCheckbox(this.tree.rootNode,e,!0),t},p.prototype.setEditMode=function(e,t){if(this.useDataCollection){var i=document.getElementById(this.id+"_label_"+e);if(null==this.editModeComp||null==this.editModeComp.render){if(!t){this.editModeComp=new WebSquare.uiplugin.input(this.id+"_input"),i.textContent="",this.editModeComp.writeTo(i),this.editModeComp.activate();var o=this.uuid;this.editModeComp.bind("onclick",(function(e){r.B.stopPropagation(e)})),this.editModeComp.bind("onblur",(function(){var e=WebSquare.idCache[o],t=e.modelControl.getDataComp(),i=this._oldValue,s=this.getValue();t.setCellData(this._index-1,e.tree.dataPath.label,s),e.appendChild(this),this.hide(),this.setValueNM(""),r.B.fireEvent(e,"oneditend",{oldValue:i,newValue:s,index:this._index})})),this.editModeComp.bind("onkeydown",(function(e){r.B.stopPropagation(e)}))}}else i.textContent="",this.editModeComp.show(),i.appendChild(this.editModeComp.render);this.editModeComp._index=e,this.editModeComp.setVerticalAlign=function(){};var s=this.findNodeByIndex(e);s&&""!=s.label&&(this.editModeComp.setValueNM(s.label),this.editModeComp._oldValue=s.label),this.editModeComp.focus()}},p.prototype.handleClickEvent=function(e){try{for(var t=!1,i=!1,o=!1,a=s.D.getDataPrefix("index"),l=s.D.getDataPrefix("value"),h=this.event.getTargetIterator(e,this.render);h.next();)if((h.match("treeview_icon_open")||h.match("treeview_icon_close"))&&(t=!0),h.match("treeview_checkbox")&&(o=!0),h.match("treeview_label")&&(i=!0),h.match("treeview_virtual_node")){var c=h.getElement().getAttribute(a),p=h.getElement().getAttribute(l),u=this.tree.findNodeByIndex(c);if(t&&"onmousedown"!==this.options.toggleButtonEvent){this.toggleChild(null,c);var f=u.childNodes&&u.childNodes[0]&&u.childNodes[0].rendered;this.inlineElement?r.B.fireEvent(this,"ontoggleclick",null,c,f):r.B.fireEvent(this,"ontoggleclick",u.element,c,f)}if(o&&!u.checkboxDisabled){var m=!u.checked;this.checkNode(c,m),this.inlineElement?r.B.fireEvent(this,"oncheckboxclick",p,null,c):1==this.options.dynamicAppend||this.useDataCollection?r.B.fireEvent(this,"oncheckboxclick",p,u.element,c):r.B.fireEvent(this,"oncheckboxclick",p,WebSquare.ModelUtil.findInstanceNode(u.xpath),c)}i&&("onclick"===this.options.toggleEvent&&this.toggleChild(null,c),this.inlineElement?r.B.fireEvent(this,"onlabelclick",p,null,c):r.B.fireEvent(this,"onlabelclick",p,u.element,c));var g=n.v.getConfiguration("/WebSquare/treeview/useClickEventToggleButton/@value"),b=s.D.getBoolean(this.options.noFocusOnIconLabelClick||n.v.getConfiguration("/WebSquare/treeview/noFocusOnIconLabelClick/@value"));(i||o||t&&"false"!=g)&&(this.selectNode1(null,c,!1,b),r.B.fireEvent(this,"onclick")),h.stop()}h=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.handleToggleEvent=function(e){try{for(var t=!1,i=this.event.getTargetIterator(e,this.render);i.next();)if(i.match("treeview_label")&&(t=!0),t&&i.match("treeview_virtual_node")){var o=s.D.getDataPrefix("index"),a=i.getElement().getAttribute(o);this.toggleChild(null,a),i.stop()}i=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.handleScrollXEvent=function(e){var t=this.dom[this.id+"_scrollX_div"].scrollLeft,i=t-this.oldScrollLeft;this.dom[this.id+"_main_div"].scrollLeft+=i,this.oldScrollLeft=t,r.B.stopEvent(e)},p.prototype.handleScrollYEvent=function(e){var t=this.uuid,i=function(){var e=WebSquare.idCache[t],i={skipScrollTop:!0};if(e._arrowDownPressed){var o=e.getNextNode(e.selectedInfo.node);o||(o=e.selectedInfo.node),e.selectNode1(null,o.index,!1,!1,i),e._arrowDownPressed=!1}else if(e._arrowUpPressed){var s=e.getPreviousNode(e.selectedInfo.node);s||(s=e.selectedInfo.node),e.selectNode1(null,s.index,!1,!1,i),
e._arrowUpPressed=!1}else if(e.selectedInfo.node)for(var a=0;a<e._items.length;a++)if(e._items[a]==e.selectedInfo.node){e.selectNode1(null,e.selectedInfo.node.index,!1,!1,i);break}if(e._checkScrollEnd()){var l=e._getOverflowY();if(l<0){var h=Math.floor(-l/this._minRowHeight),n=Math.max(1,h-this._extraRow);l=Math.min(0,l+e._maxRowHeight*n)}e._resizeY(l)}};this.options.redrawInterval>0?(n.v.clearTimer(this.id+"_redraw"),n.v.setTimer((function(){WebSquare.idCache[t].redraw(!1,i)}),{key:this.id+"_redraw",caller:this,delay:this.options.redrawInterval})):(0==this.options.redrawInterval||this._forceRedraw)&&(this.redraw(!1,i),this._forceRedraw=!1),r.B.stopEvent(e)},p.prototype.handleMouseWheelEvent=function(e){var t,i=e||window.event,o=i.detail,s=i.wheelDelta,a=1;o=(o=o?s&&(a=s/o)?o/a:-o/1.35:s/120)<1?o<-1?(-Math.pow(o,2)-224)/225:o:(Math.pow(o,2)+224)/225,t=e.deltaY?e.deltaY:-180*Math.min(Math.max(o/2,-1),1),this.dom[this.id+"_scrollY_div"].scrollTop+=t,r.B.stopEvent(e)},p.prototype.handleKeydownEvent=function(e){try{var t,i=e.charCode?e.charCode:e.keyCode,o=s.D.getDataPrefix("index");this.selectedInfo.node?(this.selectedInfo.groupDom,t=this.selectedInfo.node.index):t=(e.srcElement||e.target).getAttribute(o),t||(t=0);var a=this.tree.findNodeByIndex(t);if(37===i||39===i||13===i){var l=37!==i;13===i?this.toggleChild(null,t,null):this.toggleChild(null,t,l);var h=this;this.redraw(!1,(function(){h.selectNode1(null,h.selectedInfo.node.index,!1,!1)}));var n=!!(a.childNodes&&a.childNodes[0]&&a.childNodes[0].rendered);this.inlineElement?r.B.fireEvent(this,"ontoggleclick",null,t,n):r.B.fireEvent(this,"ontoggleclick",a.element,t,n),r.B.stopEvent(e)}else if(38===i){if(this.options.scrollFix)return void(this.dom[this.id+"_scrollY_div"].scrollTop-=1.5*this.options.rowHeight);var c=null;0==t?(t=1,c=this.tree.findNodeByIndex(t)):c=this.getPreviousNode(a),c?c.index&&this.selectNode1(null,c.index,!1):(this.dom[this.id+"_scrollY_div"].scrollTop-=2*this.options.rowHeight,this._arrowUpPressed=!0),r.B.stopEvent(e)}else if(40===i){if(this.options.scrollFix)return void(this.dom[this.id+"_scrollY_div"].scrollTop+=1.5*this.options.rowHeight);c=null;0==t?(t=1,c=this.tree.findNodeByIndex(t)):c=this.getNextNode(a),c?c.index&&this.selectNode1(null,c.index,!1):(this.dom[this.id+"_scrollY_div"].scrollTop+=2*this.options.rowHeight,this._arrowDownPressed=!0),r.B.stopEvent(e)}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.handleDblclickEvent=function(e){try{for(var t=!1,i=this.event.getTargetIterator(e,this.render);i.next();)if(i.match("treeview_label")&&(t=!0),t&&i.match("treeview_virtual_node")){var o=s.D.getDataPrefix("index"),a=i.getElement().getAttribute(o);t&&("ondblclick"!==this.options.toggleEvent&&""!==this.options.toggleEvent||this.toggleChild(null,a)),r.B.fireEvent(this,"ondblclick"),i.stop()}i=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.handleMouseoverEvent=function(e){try{r.B.stopEvent(e);for(var t=s.D.getDataPrefix("index"),i=s.D.getDataPrefix("value"),o=this.event.getTargetIterator(e,this.render);o.next();)if(o.match("treeview_label")){if(this.addClass(o.getElement(),"treeview_over"),this.options.tooltipDisplay||this.options.tooltipShowAlways){var a=o.getElement(),l=WebSquare.style.getAbsoluteLeft(a),h=WebSquare.style.getAbsoluteTop(a),n=a.firstChild.nodeValue,c=WebSquare.style.getAbsoluteLeft(this.render),p=!1;if(this.options.tooltipDisplay)if(l+a.offsetWidth>c+this.render.clientWidth+this.render.scrollLeft)p=!0;else if(s.D.isIEAllVersion()&&!s.D.isIE(6)&&!s.D.isIE(7)){var u=a.style.display;a.style.display="block",a.clientWidth<a.scrollWidth&&(p=!0),a.style.display=u}if(p||this.options.tooltipShowAlways){var f=s.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id);if(f&&"function"==typeof f){for(var m=new WebSquare.targetIterator(a,this.render),g=-1;m.next();)m.match("treeview_virtual_node")&&(g=m.getElement().getAttribute(t),m.stop());m=null;try{n=f(n,g,!!p||a.offsetWidth<a.scrollWidth)}catch(e){
d.w.printStackTrace(e,null,this)}}""!=n&&this.showTooltip(l,h,n)}}m=new WebSquare.targetIterator(o.getElement(),this.render),g=-1;for(var b="",x=null;m.next();)m.match("treeview_virtual_node")&&(g=m.getElement().getAttribute(t),b=m.getElement().getAttribute(i),x=this.tree.findNodeByIndex(g),m.stop());m=null,r.B.fireEvent(this,"onlabelover",g,x.element,b)}o=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.handleMouseoutEvent=function(e){try{r.B.stopEvent(e),(this.options.tooltipDisplay||this.options.tooltipShowAlways)&&this.hideTooltip();for(var t=this.event.getTargetIterator(e,this.render);t.next();)t.match("treeview_label")&&this.removeClass(t.getElement(),"treeview_over");t=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.handleContextmenuEvent=function(e){try{r.B.stopEvent(e);for(var t=!1,i=!1,o=!1,a=!1,l=s.D.getDataPrefix("index"),h=this.event.getTargetIterator(e,this.render);h.next();){if(h.match("treeview_label")&&(a=!0),h.match("treeview_icon_navi")&&(t=!0),h.match("treeview_icon_label")&&(i=!0),h.match("treeview_checkbox")&&(o=!0),h.match("treeview_virtual_node")){var n=h.getElement().getAttribute(l);if(t&&this.toggleChild(null,n),o){var c=document.getElementById(this.id+"_checkbox_"+n).checked;this.checkNode(n,c)}(a||o||i)&&(this.selectNode1(null,n),r.B.fireEvent(this,"onrightbuttonclick",this.findNodeByIndex(n),r.B.getMouseX(e),r.B.getMouseY(e))),h.stop()}h.match("w2treeview_virtual")&&0===this.tree.nodeCount&&(r.B.fireEvent(this,"onrightbuttonclick",null,r.B.getMouseX(e),r.B.getMouseY(e)),h.stop())}h=null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.nodeToHTML=function(e){if(!e)return"";e.rendered=!0;var t=[],i="",o="",a="",l="",h="",n="",d="",r="",c="";if(this.options.customFormatter&&(this.tree.customFormatter=s.D.getGlobalFunction(this.options.customFormatter,this.scope_id)),"function"==typeof this.tree.customFormatter){var p=this.tree.getCloneNode(e),u=this.tree.customFormatter.call(this,e.orgLabel,e.label,p)||e.label;r=this.options.escape?WebSquare.xml._encode(e.label):u,c=this.options.escape?WebSquare.xml._encode(e.value):e.value}else r=this.options.escape?WebSquare.xml._encode(e.label):e.label,c=this.options.escape?WebSquare.xml._encode(e.value):e.value;if(e.hasChild()){var f=e.isExpanded();i=f?"opened":"closed",o=f?"treeview_icon_close":"treeview_icon_open",a=f?"background: url("+this.options.folderCloseToggleImage+") no-repeat center center":"background: url("+this.options.folderOpenToggleImage+") no-repeat center center";var m=e.parentNode.childNodes;m&&m[m.length-1]==e&&(i+=" lastParentSibling")}else i="leaf",o=this.options.lineShow?e.isFirstChildByRoot()?1==e.parentNode.childNodes.length?"treeview_root_single_leaf":"treeview_root_multi_leaf":e.isLastChild()?"treeview_last_sibling":"treeview_leaf":"";var g=s.D.getDataPrefix("index"),b=s.D.getDataPrefix("value"),x=s.D.getDataPrefix("depth");i+=" w2tree_depth_"+e.depth,t.push("<div id='"+this.id+"_node_"+e.index+"' tabindex='-1' class='treeview_virtual_node "+i+"' "+g+"='"+e.index+"' "+b+"='"+c+"' "+x+"='"+e.depth+"' style='height:"+this.options.rowHeight+"px;'>");var v=!1,y=[];if(this.options.lineShow)if(e._ancestor){h="treeview_guideline",n="width: 16px;";var _=this.tree.hash_index_node[e._ancestor],k=e;for(v=!0,_.isLastChild()&&y.push(!1);k!=_;)y[k.depth-1]=!k.isLastChild(),k=k.parentNode}else h="treeview_no_guideline",n="width:"+16*(e.depth-1)+"px;";else h="treeview_no_guideline",n="width:"+16*(e.depth-1)+"px;";if(v)for(var N=0;N<e.depth-1;N++)h=0==y[N]?"treeview_no_guideline":"treeview_guideline",t.push("<span class='"+h+"' style='"+n+"'> </span>");else t.push("<span class='"+h+"' style='"+n+"'> </span>");if(t.push("<span class='treeview_icon_navi "+o+"' style='"+a+"'></span>"),""!=e.image){var I=e.isExpanded()?e.expandedImage:e.image,w=e.imageTitle?"title='"+e.imageTitle+"'":"";t.push("<span id='"+this.id+"_icon_"+e.index+"' class='treeview_icon_label'"+w+" style='background-image:url("+I+")'></span>")}
if(1==this.options.showCheckbox){var C=e.checked||e.partial?"checked='true' ":"",S=e.checkboxDisabled?"disabled='true' ":"",D=e.partial?"treeview_partialselect":"";!0===this.options.labelForCheckbox&&(d="for='"+this.id+"_checkbox_"+e.index+"'"),t.push("<input tabindex='-1' style='"+this.checkboxStyle+"' type='checkbox' "+C+S+" id='"+this.id+"_checkbox_"+e.index+"' class='treeview_checkbox "+D+"' />")}return e.labelStyleStr&&(l=e.labelStyleStr),t.push("<label "+d+" class='treeview_label "+this.options.labelclass+"' tabindex='-1' style='"+l+"' id='"+this.id+"_label_"+e.index+"'>"+r+"</label>"),t.push("</div>"),t.join("")},p.prototype.isLeaf=function(){try{return!this.selectedInfo||!this.selectedInfo.node||!this.selectedInfo.node.hasChild()}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._getDataObj=function(e){if(e){var t=WebSquare.WebSquareparser.parseItemset(e);this.modelControl.setItemset(t.nodeset,t.label,t.value),0==this.options.modelBinding&&(this.options.refreshCheckboxModel=!1,this.options.refreshCheckboxDisableModel=!1);var i={type:"",data:null},o=null,s=WebSquare.Elem.api.getElementsByTagName(e,"itemset",n.v._XML_NAMESPACE.W2)[0];if(s){var a=WebSquare.Elem.api.getValue(s,"@nodeset");this.useDataCollection=a.match("data:");var l=a.replace(/\[[^\[\]]*\]/g,"").match(/[^\/]*$/);l&&(l=l[0]);var h=WebSquare.Elem.api.getElementsByTagName(s,"label",n.v._XML_NAMESPACE.W2)[0],d=WebSquare.Elem.api.getElementsByTagName(s,"value",n.v._XML_NAMESPACE.W2)[0],r=WebSquare.Elem.api.getElementsByTagName(s,"depth",n.v._XML_NAMESPACE.W2)[0],c=WebSquare.Elem.api.getElementsByTagName(s,"folder",n.v._XML_NAMESPACE.W2)[0],p=null==h?"":h.getAttribute("ref"),u=null==d?"":d.getAttribute("ref"),f=null==r?"":r.getAttribute("ref"),m=null==c?"":c.getAttribute("ref"),g={image:"image",iconImage:"iconImage",selectedImage:"selectedImage",expandedImage:"expandedImage",leafImage:"leafImage",checkboxDisabled:"checkboxDisabled",imageTitle:"imageTitle",checkbox:"checkbox"};for(var b in g){var x=WebSquare.Elem.api.getElementsByTagName(s,""+b,n.v._XML_NAMESPACE.W2)[0];g[b]=null==x?"":x.getAttribute("ref")}var v=g.checkbox;this.useDataCollection&&this.tree.setDataPath(p,u,f,l,m,v);var y=g.image,_=g.iconImage,k=g.selectedImage,N=g.expandedImage,I=g.leafImage,w=g.checkboxDisabled,C=g.imageTitle;v=g.checkbox;if(y=""!=this.options.defaultImage?this.options.defaultImage:y,_=""!=this.options.iconImage?this.options.iconImage:_,k=""!=this.options.selectedImage?this.options.selectedImage:k,N=""!=this.options.expandedImage?this.options.expandedImage:N,I=""!=this.options.leafImage?this.options.leafImage:I,w=""!=this.options.checkboxDisabled?this.options.checkboxDisabled:w,this.tree.setXPath(a,p,u,f,l,m),this.tree.setCheckbox(v,this.options.trueValue,this.options.falseValue,w,this.options.checkboxDisabledTrueValue,this.options.checkboxDisabledFalseValue,this.options.checkboxDisabledAll,this.options.refreshCheckboxModel,this.options.refreshCheckboxDisableModel,this.options.hierarchy,g.checkbox),this.tree.setImage(y,_,I,k,N,C),this.useDataCollection)this.modelControl.getDataCollectionItemsetData(this.modelControl.id),null!=(o=this.modelControl.getDataComp())&&(i.type="dataList",i.data=o.id,this.successBinding=!0);else{var S=WebSquare.ModelUtil.findInstanceNodes(a,null,this.scope_id),D=null;null!=S&&("recursive"==this.options.dataType?D=this.tree.parseRecursiveToTree(S):"listed"==this.options.dataType&&(D=this.tree.parseListToTreeInstance(S))),i.type="xmlInstance",i.data=D,this.tree.isInstance=!0}}else{this.inlineElement=!0;y="w2:image",_="w2:iconImage",k="w2:selectedImage",N="w2:expandedImage",I="w2:leafImage";y=""!=this.options.defaultImage?this.options.defaultImage:y,_=""!=this.options.iconImage?this.options.iconImage:_,k=""!=this.options.selectedImage?this.options.selectedImage:k,N=""!=this.options.expandedImage?this.options.expandedImage:N,I=""!=this.options.leafImage?this.options.leafImage:I,this.tree.setImage(y,_,I,k,N,"w2:imageTitle"),
this.tree.setCheckbox("w2:checkbox",this.options.trueValue,this.options.falseValue,"w2:checkboxDisabled",this.options.checkboxDisabledTrueValue,this.options.checkboxDisabledFalseValue,this.options.checkboxDisabledAll,this.options.refreshCheckboxModel,this.options.refreshCheckboxDisableModel,this.options.hierarchy),i.type="inlineXML",i.data=e}return i}},p.prototype.refreshItemset=function(e){try{if(this.modelControl.isItemsetBinded()&&!this.refreshStop){this._initMaxRowHeight(),this.refreshStop=!0,this._expandedNodes=[];var t=this.tree.getNodeset(),i=!1;if(this.useDataCollection){var o;if(null!=(o=this.modelControl.getDataComp())){if(!this.successBinding){var s=(t=o.options.baseNode+"/"+o.options.repeatNode).replace(/\[[^\[\]]*\]/g,"").match(/[^\/]*$/);s&&(s=s[0]),this.tree.valueAttribute=o.options.valueAttribute?o.options.valueAttribute:"";var a=this.tree.dataPath.label,l=this.tree.dataPath.value,h=this.tree.dataPath.depth,n=this.tree.dataPath.folder,r=this.tree.dataPath.checkbox;this.tree.setDataPath(a,l,h,s,n,r),this.successBinding=!0,i=!0}this.tree.setData({type:"dataList",data:o.id})}}else{var c=WebSquare.ModelUtil.findInstanceNodes(t,null,this.scope_id),p=null;null!=c&&("recursive"==this.options.dataType?p=this.tree.parseRecursiveToTree(c):"listed"==this.options.dataType&&(p=1==this.tree.isInstance?this.tree.parseListToTreeInstance(c):this.tree.parseListToTree(c))),this.tree.setData({type:"xmlInstance",data:p})}if(this._expandedNodes.push(this.tree.rootNode),this._setExpandedLevel(),i)if(e&&!0===e.setNodeSet){if(this.redraw(!0),this.useDataCollection)(o=this.modelControl.getDataComp()).bind("onbeforecelldatachange",this.event.bindAsEventListener(this,this.notifyValidCheck))}else this.setAction(),this.refreshStop=!0;else this.redraw(!0);if(this.useDataCollection)null!=(o=this.modelControl.getDataComp())&&o.getRowPosition();this.refreshStop=!1}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.refreshItemArr=function(){},p.prototype.setNodeSet=function(e,t){try{var i=t||{},o=e;if(e.indexOf("data:")>=0&&(o=e.replaceAll("data:","")),this.modelControl.getDataComp(o)){for(var s in this.useDataCollection=e.match("data:"),this.modelControl.unbindItemset(),this.modelControl.setItemset("data:"+o,i.label,i.value),this.modelControl.dataCollectionBindItemset(),this.modelControl.getDataCollectionItemsetData(this.modelControl.id),t)this.tree.dataPath[s]=t[s],"checkbox"===s&&(this.tree.checkbox.colID=t[s]);this.successBinding=!1,this.refreshItemset({setNodeSet:!0})}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.stopRefresh=function(e){try{this.refreshStop=s.D.getBoolean(e)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyValidCheck=function(e){try{if(e.colID===this.tree.dataPath.depth){var t=this.findNodeByIndex(e.rowIndex+1);if(e.newValue<1)throw{message:"Invalid value : [label : "+t.label+", newDepth : "+e.newValue+"]. The depthValue must be greater than 0."};if(e.oldValue&&e.newValue>e.oldValue&&t.isFirstChild())throw{message:"Invalid value : [label : "+t.label+", newDepth : "+e.newValue+"]. The depthValue must be less than "+(e.oldValue+1)}}return!0}catch(e){return d.w.printStackTrace(e,null,this),!1}},p.prototype.notifyInvalid=function(){},p.prototype.notifySetCellData=function(e,t,i,o){try{if(this.refreshStop||parseInt(o,10)===parseInt(i,10))return;if(t===this.tree.dataPath.label)this.setLabelByIndex(e+1,i,!0);else if(t===this.tree.dataPath.checkbox)i==this.options.trueValue?this.checkNode(e+1,!0):i==this.options.falseValue&&this.checkNode(e+1,!1);else if(t===this.tree.dataPath.depth){if(Math.abs(i-o)>1)return void this.refreshItemset();this.stopRefresh(!0),this.notifyDepthChanged(e+1,i,o),this.stopRefresh(!1);var s=this.findNodeByIndex(e+1);s.parentNode===this.tree.rootNode?this.redraw():this.toggleChild(null,s.parentNode.index,!0)}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyDepthChanged=function(e,t,i){try{var o=this.findNodeByIndex(e),s=this.modelControl.getDataComp()
;if(this._initMaxRowHeight(),t>i){var a=(r=o.parentNode).childNodes[o.depthIndex-2],l=o.childNodes.splice(0,o.childNodes.length);r.childNodes.splice(o.depthIndex-1,1),o.parentNode=a,a.childNodes.push(o),o.depthIndex=a.childNodes.length,a.rendered=!1,o.rendered=!1;for(var h=0;h<l.length;h++)l[h].parentNode=a,a.childNodes.push(l[h]),l[h].depthIndex=a.childNodes.length,l[h].rendered=!1;r.childNodes[0].rendered=!1}else{if(o.hasChild())for(h=o.childNodes.length-1;h>=0;h--){var n=o.childNodes[h];s.setCellData(n.index-1,this.tree.dataPath.depth,n.depth-1),this.notifyDepthChanged(n.index,n.depth-1,n.depth)}var r,c=(r=o.parentNode).parentNode;if(o.depthIndex<r.childNodes.length){var p=r.childNodes.splice(o.depthIndex,r.childNodes.length-o.depthIndex);for(h=0;h<p.length;h++)p[h].parentNode=o,o.childNodes.push(p[h]),p[h].depthIndex=o.childNodes.length,p[h].rendered=!1}r.childNodes.splice(r.childNodes.length-1,1),o.parentNode=c,c.childNodes.splice(r.depthIndex,0,o);for(h=r.depthIndex;h<c.childNodes.length;h++)c.childNodes[h].depthIndex=h+1;c.childNodes[0].rendered=!1}o.depth=t,o.element.setAttribute(s.options.valueAttribute,t)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyInsertRow=function(e){try{if(this.refreshStop)return;this._initMaxRowHeight();var t=this.modelControl.getDataComp(),i=this.findNodeByIndex(e),o=new l;o.index=e+1,o.depthIndex=1,o.depth=i.depth+1,o.rendered=!1,o.parentNode=i;for(var s=t.getRowCount();s>=e+2;s--)this.tree.changeNodeIndex(s-1,s);this.tree.hash_index_node[e+1]=o,t.setCellData(e,this.tree.dataPath.depth,i.depth+1,null,!0);var a=t.getRowJSON(e),h={T:1,N:"data",A:{index:""+e},E:[]};for(var n in a){var r={T:1,N:n,parent:h};""!=a[n]&&(r.E=[],r.E.push({T:3,text:""+a[n]})),h.E.push(r)}o.element=new WebSquare.Elem(h),i.childNodes.unshift(o);for(s=0;s<i.childNodes.length;s++)i.childNodes[s].depthIndex=s+1;this.toggleChild(null,e,!0),this.tree.nodeCount=t.getRowCount()+1}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyBeforeSetRowData=function(e,t){try{if(this.refreshStop)return;this._initMaxRowHeight();var i=this.modelControl.getDataComp();this.beforeSetRowData=t?{depth:i.getCellData(e,this.tree.dataPath.depth),label:i.getCellData(e,this.tree.dataPath.label),checkbox:i.getCellData(e,this.tree.dataPath.checkbox),overwrite:t}:{depth:Number(i.getCellData(e-1,this.tree.dataPath.depth))+1,label:"",checkbox:"",overwrite:t}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifySetRowData=function(e){try{if(this.refreshStop)return;this._initMaxRowHeight();var t,i=(t=this.modelControl.getDataComp()).getCellData(e,this.tree.dataPath.depth),o=t.getCellData(e,this.tree.dataPath.label),s=t.getCellData(e,this.tree.dataPath.checkbox);if(i!=this.beforeSetRowData.depth)if(this.notifyValidCheck({colID:this.tree.dataPath.depth,oldValue:this.beforeSetRowData.depth,newValue:i}))this.notifySetCellData(e,this.tree.dataPath.depth,i,this.beforeSetRowData.depth);else(t=this.modelControl.getDataComp()).setCellData(e,this.tree.dataPath.depth,this.beforeSetRowData.depth);o!=this.beforeSetRowData.label&&this.notifySetCellData(e,this.tree.dataPath.label,o,this.beforeSetRowData.label),s!=this.beforeSetRowData.checkbox&&this.notifySetCellData(e,this.tree.dataPath.checkbox,s,this.beforeSetRowData.checkbox),this.beforeSetRowData={},this.tree.nodeCount=t.getRowCount()+1}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyRemoveRow=function(e){try{if(this.refreshStop)return;this._initMaxRowHeight();var t=this.findNodeByIndex(e+1),i=t.parentNode,o=document.getElementById(this.id+"_group_"+t.index);if(o&&WebSquare.removeNode(o),this.stopRefresh(!0),this.notifyRemoveRow_allChildren(e),this.stopRefresh(!1),0==i.index)i._hasChild=i.folder?null:0!=i.childNodes.length,this.redraw();else{var s=this.findNodeByIndex(e);if(s&&!s.isRoot()){if(s.isLastChild()){var a=document.getElementById(this.id+"_node_"+s.index);this.addClass(a,"w2treeview_last_sibling"),this.removeClass(a,"w2treeview_first_sibling"),
s.isLeaf()&&this.addClass(a,"w2treeview_last_leaf")}else if(s.isFirstChild()){a=document.getElementById(this.id+"_node_"+s.index);this.addClass(a,"w2treeview_first_sibling")}if(s.parentNode.isLastChild()){var l=document.getElementById(this.id+"_guideline_"+s.parentNode.index);this.removeClass(l,"w2treeview_guideline"),this.addClass(l,"w2treeview_noguideline")}}}var h=this.modelControl.getDataComp();this.tree.nodeCount=h.getRowCount()+1}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyRemoveRow_allChildren=function(e){try{this._initMaxRowHeight();var t=this.findNodeByIndex(e+1),i=t.parentNode,o=this.modelControl.getDataComp(),s=e,a=o.getRowCount()+1,l=1;if(t.hasChild()){s=a-1;for(var h=t;!h.isRoot()&&h.depthIndex==h.parentNode.childNodes.length;)h=h.parentNode;h.isRoot()||h.depthIndex==h.parentNode.childNodes.length||(s=h.parentNode.childNodes[h.depthIndex].index-2);for(var n=[],r=e;r<s;r++)n.push(r),this.tree.clearNode(this.tree.findNodeByIndex(r+2)),l++;o.removeRows(n)}i.childNodes.splice(t.depthIndex-1,1);for(r=t.depthIndex-1;r<i.childNodes.length;r++)i.childNodes[r].depthIndex=r+1;this.tree.clearNode(t);for(r=s+2;r<=a;r++)this.tree.changeNodeIndex(r,r-l);this.tree.nodeCount=o.getRowCount()+1}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.notifyDataChanged=function(e){try{this.stopRefresh(!1),this.refreshItemset()}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.getDataListInfo=function(){try{if(this.modelControl.isDataCollectionItemsetBinded){var e={};return e.id=this.modelControl.dataCollectionItemsetInfo.dataComp.id,e.nodeset=this.modelControl.itemsetObj.nodeset,e.label=this.modelControl.itemsetObj.label,e.value=this.modelControl.itemsetObj.value,e}return null}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.deselectNode=function(){try{if(this.selectedInfo&&this.selectedInfo.node){var e=this.selectedInfo.node?this.tree.getCloneNode(this.selectedInfo.node):null,t=s.D.getBoolean(this.options.useHirarchySelect);if(this.selectedInfo.dom&&(this.removeClass(this.selectedInfo.dom,this.options.labelonClickClass),this.selectedInfo.dom.style.backgroundColor=this.originalBackgroundColor,this.selectedInfo.dom.style.color=this.originalColor),t&&this.selectedInfoStack.length>0){for(var i=0;i<this.selectedInfoStack.length;i++){var o=this.selectedInfoStack[i];o.dom&&(this.removeClass(o.dom,this.options.labelonClickClass),o.dom.style.backgroundColor=o.org.background,o.dom.style.color=o.org.color)}this.selectedInfoStack=[]}r.B.fireEvent(this,"onchange",e,null),this.selectedInfo={groupDom:null,dom:null,node:null}}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.setShowCheckBox=function(e){try{this.options.showCheckbox!=e&&(this.options.showCheckbox=e,this.redraw(!0))}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.checkResize=function(){try{if(this.render){var e=this.render.offsetWidth,t=this.render.offsetHeight;if(this.resizeObj&&e>0&&t>0)if(0==this.resizeObj.width&&0==this.resizeObj.height)this.refreshItemset();else{var i=e-this.resizeObj.width,o=t-this.resizeObj.height;0==i&&0==o||this.redraw(!0)}this.resizeObj={width:e,height:t}}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype.fixScrollTop=function(e){try{document.getElementById(this.id+"_main_div").scrollTop=0,WebSquare.event.preventDefault(e)}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._checkScrollEnd=function(){try{var e=document.getElementById(this.id+"_scrollY_div");return e.scrollTop+this._epsilon>=e.scrollHeight-e.offsetHeight}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._getVisibleInfo=function(){try{for(var e=this.getElementById(this.id+"_main_div"),t=0,i=0,o=0;o<e.childNodes.length;o++){var s=e.childNodes[o].offsetHeight;t+=s,this._maxRowHeight=Math.max(this._maxRowHeight,s),this._minRowHeight=Math.min(this._minRowHeight,s),e.offsetHeight>t&&i++}return{height:t,rowCount:i}}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._getLastRowHeight=function(){try{
var e=this.getElementById(this.id+"_main_div");return e.childNodes[e.childNodes.length-1].offsetHeight}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._getOverflowY=function(){try{var e=this.getElementById(this.id+"_main_div");return this._getVisibleInfo().height-e.offsetHeight}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._resizeY=function(e){try{if(isNaN(e)||0===Number(e))return;var t;t=e>0?Math.ceil(e/this.options.rowHeight)*this.options.rowHeight:Math.floor(e/this.options.rowHeight)*this.options.rowHeight;var i=this.getElementById(this.id+"_scrollY_scrollbar");i.style.height=i.offsetHeight+t+"px";var o=this.id+"_scrollY_div";s.D.requestAnimationFrame((function(){document.getElementById(o).scrollTop+=t}))}catch(e){d.w.printStackTrace(e,null,this)}},p.prototype._initMaxRowHeight=function(){try{this._maxRowHeight=this.options.rowHeight||0,this._minRowHeight=this.options.rowHeight||0}catch(e){d.w.printStackTrace(e,null,this)}}}}]);