(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[1804],{1804:function(t,e,i){"use strict";i.r(e),i.d(e,{selectbox:function(){return p},selectbox_native:function(){return c}});var s=i(9122),o=i(7827),l=i(1160),n=i(5841),r=i(8754),a=i(5316),h=i(3721),d=i(8463),p=function(t,e,i){a.s.call(this,t,e,i)};s.x.extend(p.prototype,a.s.prototype),s.x.extend(p.prototype,h.E.prototype),s.x.extend(p.prototype,d.z.prototype),p.prototype.defaultOptions={pluginType:"uiplugin.selectbox",pluginName:"selectbox",renderType:"component",mobileRenderType:"",serializable:!0,userEvents:["onchange","onclose","onviewchange","onblur","ontooltipshow","ontooltiphide","onselected"],systemEvents:["onclick","ondblclick","onfocus","onblur","onkeydown","onkeyup"],useOtherComponentId:"",useConfig:!0,value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",wmode:!1,visibleRowNum:5,displayMode:"0",delimiter:"\t",textAlign:"",defaultStyle:"",activeStyle:"",defaultClass:"w2SelectDefault",activeClass:"w2SelectActive",disabledClass:"w2selectbox_disabled",useLocale:!1,submenuSize:"auto",direction:"auto",tableRender:"",tooltipDisplay:!1,tooltipShowAlways:!1,tooltipClass:"",tooltipTime:1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",title:"",setDataRemoveAll:!0,escape:!0,emptyItem:!1,emptyValue:"",emptyIndex:0,optionOrder:"choose",animation:"",closeonmouseleave:!1,selectedData:!0,dataListAutoRefresh:!1,refreshSelectedIndex:!1,preventWheelEvent:!1,customFormatter:"",customLabelFormatter:"",keyMoveListSync:!1,keyMoveSync:!0,wheelRows:0,visibleColumn:"",visibleColumnFalseValue:"0,false,FALSE,F",findItemFirstKey:!0,enableColumn:"",enableColumnFalseValue:"0,false,FALSE,F",depthColumn:"",depthColumnWidth:0,depthColumnHeight:0,depthColumnShowPath:!1,depthColumnPathDelimiter:"-",keyBufferResetTime:1e3,customToggleKey:"",preventKeyList:"",valueNotInList:"default"},p.prototype.initialize=function(t){try{if(this._initializeCommon(t&&"$blank"==t.getAttribute("chooseOptionLabel")),this.gridOptions={},this.gridViewOptions={},t){var e="xf"==t.getTagName().split(":")[0]?o.v._XML_NAMESPACE.XFORMS:o.v._XML_NAMESPACE.W2,i=WebSquare.Elem.api.getElementsByTagName(t,"choices",e)[0];if(i){var s=WebSquare.Elem.api.getElementsByTagName(i,"gridItemset",o.v._XML_NAMESPACE.W2)[0];null==s&&(s=WebSquare.Elem.api.getElementsByTagName(i,"gridViewItemset",o.v._XML_NAMESPACE.W2)[0]),s&&"w2:gridItemset"==s.getTagName()?this.itemTableMode="grid":s&&"w2:gridViewItemset"==s.getTagName()&&(this.itemTableMode="gridView")}else"gridViewItemset"==this.options.itemTableType&&(this.itemTableMode="gridView")}"grid"==this.itemTableMode?this.initializeGridItemArr(t):"gridView"==this.itemTableMode?this.initializeGridViewItemArr(t):this.initializeItemArr(t);var n=r.D.isMobile();if("ul"!==this.options.tableRender||"auto"==this.options.renderType&&n||(this.options.renderType="component"),this.options.customLabelFormatter&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),this.myhelper=new WebSquare.korHelper,this._preventKeyObj={},this.options.preventKeyList)if("all"===this.options.preventKeyList)this._preventKeyObj.all=!0;else for(var a=this.options.preventKeyList.split(","),h=0;h<a.length;h++){var d=a[h].wq_trim();d&&(this._preventKeyObj[d]=!0)}this.options.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype._initializeCommon=function(t){try{this.itemTable=null,this.isOpen=!1,this.statusSubLayer=!1,this.selectedIndex=-1,this.selectedAllIndex=-1,this.cursorIndex=-1,this.showRowIndex=0,this.displayCount=0,this.tooltip=null,this.timeShowTooltip=null,
this.timeHideTooltip=null,this.defaultAllOptionLabel=WebSquare.language.getMessage("SelectBox_all");var e=o.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/chooseOptionLabel/@value");this.defaultChooseOptionLabel=t||!t&&"$blank"===e?"":WebSquare.language.getMessage("SelectBox_choose"),this._initDisplayMode(),this.options.selectedData="false"!=this.options.selectedData&&!1!==this.options.selectedData,this.refreshStop=!1,this.validator=new WebSquare.validator.validateInvoker(this.id,this.options),this.isFireTooltipEvent=!1,this._keyBuffer="",this.keyCharHash={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"},this.korCharHash={65:"ㅁ",67:"ㅊ",68:"ㅇ",69:"ㄷ",70:"ㄹ",71:"ㅎ",81:"ㅂ",82:"ㄱ",83:"ㄴ",84:"ㅅ",86:"ㅍ",87:"ㅈ",88:"ㅌ",90:"ㅋ"},this.korCharHash2={69:"ㄸ",81:"ㅃ",82:"ㄲ",84:"ㅆ",87:"ㅉ"},this.options.depthColumn&&(this.options.tableRender="ul")}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.finalize=function(){try{a.s.prototype.finalize.call(this),this.labelRuler&&(this.labelRuler.parentNode.removeChild(this.labelRuler),this.labelRuler=null),this.itemTable&&(this.itemTable.remove(),this.itemTable=null)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.toHTML=function(){try{var t=[],e=""==this.options.style?"":"style='"+this.options.style+"'",i="";i=!0===this.options.disabled?"":""===this.options.tabIndex?"tabIndex='0'":"tabIndex='"+this.options.tabIndex+"'";var s=""==this.options.title?"":"title='"+this.options.title+"'",o=""==this.options.defaultStyle?"":"style='"+this.options.defaultStyle+"'",n=""==this.options.textAlign?o:"style='text-align:"+this.options.textAlign+";"+this.options.defaultStyle+"'";return"ul"===this.options.tableRender?(t.push("<div id='"+this.id+"' "+e+" class='w2selectbox "+this.options.className+"' "+s+">"),t.push("<a id='"+this.id+"_main_tbody' class='w2selectbox_ul_table_main' href='#"+this.id+"_itemTable' aria-haspopup='true' aria-expanded='false' onclick='event.returnValue=false; return false;'>"),t.push("<div class='w2selectbox_ul_col_label' "+o+"><span id='"+this.id+"_label' class='w2selectbox_ul_label' "+n+"></span></div>"),t.push("<span class='w2selectbox_ul_col_arrow'></span>"),t.push("</a>"),t.push("</div>")):(t.push("<div id='"+this.id+"' role='combobox' aria-labelledby='"+this.id+"_itemTable' aria-autocomplete='none' "+e+" class='w2selectbox "+this.options.className+"' "+i+" "+s+">"),t.push("<table class='w2selectbox_table_main'>"),t.push("<tbody id='"+this.id+"_main_tbody'>"),t.push("<tr class='w2selectbox_row w2selectbox_row_main'>"),t.push("<td class='w2selectbox_col_label' "+o+"><div id='"+this.id+"_label' role='document' aria-live='assertive' aria-automatic='true' class='w2selectbox_label' "+n+"></div></td>"),t.push("<td class='w2selectbox_col_button' id='"+this.id+"_button'  aria-labelledby='"+this.id+"_itemTable' aria-controls='"+this.id+"_itemTable'></td>"),t.push("</tr></tbody>"),t.push("</table>"),t.push("</div>")),t.join("")}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setPreAction=function(){try{this.options.itemTooltipDisplay&&this.options.itemTooltipFormatter&&(this.itemTooltipFormatter=r.D.getGlobalFunction(this.options.itemTooltipFormatter,this.scope_id)),this.dom.button=this.getElementById(this.id+"_button"),this.dom.label=this.getElementById(this.id+"_label"),this.dom.tbody=this.getElementById(this.id+"_main_tbody"),this.options.useOtherComponentId?o.v.setTimer((function(){this.otherComponent=r.D.getComponentById(this.options.useOtherComponentId),WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.options.useOtherComponentId,WebSquare.getBody().getLayerListener().addListener({
component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.otherComponent.render,"onmousedown",this.event.bindAsEventListener(this.otherComponent,(function(t){n.B.stopPropagation(t)}))),this.otherComponent.hide()}),{key:this.options.useOtherComponentId,caller:this,delay:100}):"grid"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):"gridView"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridViewItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openSubLayer,fnHide:this._closeSubLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),r.D.isMobile()?(this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,(function(t){n.B.stopPropagation(t)}))),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,(function(t){1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll(),this._closeSubLayer()})))):this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(t){n.B.stopPropagation(t)}))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyupEvent)),this.event.addListener(this.render,"onmousewheel",this.event.bindAsEventListener(this,this.handleMousewheelEvent)),this.event.addListener(this.render,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.render,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),1==this.options.closeonmouseleave&&this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,this.handleMouseleaveEvent)),this.modelControl.isItemsetBinded()?(this.refreshItemArr(),this.componentRedraw()):!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength()}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var t=document.getElementById(this.id).style.cssText,e=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:t,className:e}}if(this.modelControl.isBinded()){var i=this.modelControl.getData();this.setValueNM(i)}if(-1==this.selectedIndex&&this.getItemCount()>0&&(0==this.options.emptyIndex||!this.options.emptyIndex))if(this.modelControl.isBinded()){i=this.getValue();if(this.options.emptyRef){for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value==i){this.setSelectedIndexNM(0),this.modelControl.setData(i);break}}else this.setSelectedIndexNM(0),this.modelControl.setData(i)}else this.setSelectedIndexNM(0),this.broadcast({linkedDataList:["refresh",["replace"]]});else this.options.emptyIndex&&"number"==typeof this.options.emptyIndex?this.modelControl.isBinded()?(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(this.options.emptyIndex),this.broadcast({linkedDataList:["refresh",["replace"]]
})):this.selectedIndex>0&&this.getItemCount()>0&&(this.modelControl.isBinded()||(this.setSelectedIndexNM(this.selectedIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})));this.options.mandatory&&this.onPropertyChange("mandatory",r.D.getBoolean(this.options.mandatory))}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.onComplete=function(){try{this.options.customFormatter&&this.customFormatter(),a.s.prototype.onComplete.call(this)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.customFormatter=function(){try{var t=null;"grid"===this.itemTableMode||"gridView"===this.itemTableMode||("function"==typeof this.options.customFormatter?t=this.options.customFormatter:null!=(t=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=t),"function"==typeof t&&(this.modelControl.isBinded()&&!this.modelControl.isDataCollectionItemsetBinded&&this.refreshItemArr(),this.itemArr=t.call(this,this.itemArr),this.componentRedraw()))}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.refreshItemset=function(t,e){try{if(this.refreshStop)return;if(this.modelControl.isItemsetBinded())if(this.refreshItemArr(),this.componentRedraw(!1,t,e),"grid"==this.itemTableMode?(this.refreshGridItemArr(),null!=this.itemTable&&null!=this.itemTable.grid?(this.itemTable.grid.clearFilter(),this.setGridData(),this.options.allOption&&this.gridItemArr.length>0&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))):1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))):"gridView"==this.itemTableMode&&(this.refreshGridViewItemArr(),null!=this.itemTable&&null!=this.itemTable.gridView?"dataList"===this.gridViewOptions.dataComp.initializeType&&this.setGridViewData():1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))),this.modelControl.isBinded())this.refresh();else{if(this.options.customFormatter&&this.customFormatter(),"auto"==this.options.submenuSize&&this.itemTable&&"grid"!==this.itemTableMode&&"gridView"!==this.itemTableMode&&!0!==this.refreshStopItemTable){var i=this.getMaxLabelSize();this.itemTable.setStyle("width",i+"px")}-1!=this.getSelectedIndex()||null!=this.getValue()&&""!==this.getValue()&&"keepValue"!==this.options.valueNotInList||this.setSelectedIndexNM(0)}this.isOpen&&this.setItemTable(),this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.refresh=function(){try{if(this.refreshStop)return;if(this.modelControl.isBinded()){var t=this.modelControl.getDataComp(),e=this.getItemCount();if(t&&"linkedDataList"===t.initializeType&&(this.options.chooseOption||this.options.allOption)&&(1!=e||this.itemArr[0].label!==this._getChooseOptionLabel()&&this.itemArr[0].label!==this.defaultAllOptionLabel?2==e&&this.itemArr[0].label===this._getChooseOptionLabel()&&this.itemArr[1].label===this.defaultAllOptionLabel&&(e-=2):e--),e>0){this.modelControl.isDataCollectionItemsetBinded&&this.refreshItemArr();var i=this.getValue(),s=this.modelControl.getData();this.options.customFormatter&&this.customFormatter();var o=this.setValueNM(s);1==o?(i!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:i,newValue:this.getValue()}),null!=this.getValue()&&s!=this.getValue()&&this.modelControl.setData(this.getValue()),this.broadcast({linkedDataList:["refresh",["replace"]]})):isNaN(o)?null!=this.getValue()&&s!=this.getValue()&&this.modelControl.setData(this.getValue()):this._setValueNotInList(s,!1)}}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.changeChooseOption=function(t,e){try{var i=-2;if(!0===this.options.chooseOption){i=-1;for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value===this.options.chooseOptionValue){i=o;break}
i>-1&&this.itemArr.splice(i,1)}this.options.chooseOption=!0,this.options.chooseOptionValue=t,this.options.chooseOptionLabel=e,this.itemArr=[{label:e,value:t}].concat(this.itemArr),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),i!==this.getSelectedIndex()&&-1!==this.getSelectedIndex()||this.setSelectedIndex(0)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.showChooseOption=function(t){try{var e=this._getChooseOptionLabel();e=WebSquare.xml.decode(e).replace("&nbsp;"," ");var i=this.options.chooseOptionValue;if(1==t)this.options.chooseOption!=t&&("all"==this.options.optionOrder&&1==this.options.allOption?this.itemArr.splice(1,0,{label:e,value:i}):this.itemArr=[{label:e,value:i}].concat(this.itemArr));else if(this.options.chooseOptions!=t)for(var s=0;s<this.itemArr.length;s++)if(this.itemArr[s].label==e){this.itemArr.splice(s,1);break}this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),-2!==this.getSelectedIndex()&&-1!==this.getSelectedIndex()&&0!==this.getSelectedIndex()||this.setSelectedIndex(0),this.options.chooseOption=t}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.componentRedraw=function(t,e,i){try{if(this.refreshStop)return;if(this.showRowIndex=0,!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.setSelectOptions(),this.itemArr.length>0){var s=0;if(e||this.options.refreshSelectedIndex&&"insertRow"===i)return"insertRow"!==i&&"replace"!=e&&this.getSelectedIndex()>-1&&(s=this.getSelectedIndex()),void this.setSelectedIndexNM(s);if(this.options.refreshSelectedIndex&&"setCellData"===i)s=this.getSelectedIndex();else if(this.modelControl.isItemsetBinded()&&!this.modelControl.isBinded()&&-1!==this.selectedIndex)return void(this.options.emptyItem?this.setSelectedIndexNM(-1):this.setSelectedIndexNM(0));if(this._setLabel(s),this.options.refreshSelectedIndex&&"setCellData"===i)return}else this.dom.label&&(this.dom.label.innerHTML="");this.setValueNM("")}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setLabelWidthByItemLength=function(){try{var t=this.getMaxLabelSize();this.render&&(this.render.style.width=t+"px")}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.getMaxLabelSize=function(){try{this.labelRuler||(this.labelRuler=document.createElement("div"),this.labelRuler.style.position="absolute",this.labelRuler.style.top="-1000px",this.labelRuler.style.left="-1000px",this.labelRuler.style.visibility="hidden",document.body.appendChild(this.labelRuler));for(var t=0,e=0;e<this.itemArr.length;e++)this.labelRuler.innerHTML=this.itemArr[e].label,this.labelRuler.offsetWidth>t&&(t=this.labelRuler.offsetWidth);var i=document.getElementById(this.id+"_button"),s=0;return i&&(s=i.offsetWidth||parseInt(WebSquare.style.getComputedStyle(i,"width"))),t+s+10}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setSubLayer=function(){try{var t=this;if(null==this.itemTable){if("grid"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridOptions.width||(this.gridOptions.parentWidth=this.render.offsetWidth),this.gridOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridItemTable(this.id+"_gridItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridOptions:this.gridOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.grid.addEvent("oncellclick",(function(e,i){t.focus(),
"dataList"===t.gridViewOptions.dataComp.initializeType&&(e=this.getRealRowIndex(e)),t.setSelectedIndex1(e)})),this.event.addListener(this.itemTable.grid.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.grid,(function(e){var i=e.charCode?e.charCode:e.keyCode;if(13==i){t.focus();var s=this.getFocusedRowIndex();"dataList"===t.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),t.setSelectedIndex1(s)}else 27==i&&(t._closeSubLayer(),t.focus())}))),this.setGridData();else if("gridView"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridViewOptions.width||(this.gridViewOptions.parentWidth=this.render.offsetWidth),this.gridViewOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridViewItemTable(this.id+"_gridViewItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridViewOptions:this.gridViewOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.gridView.addEvent("oncellclick",(function(e,i){t.focus(),"dataList"===t.gridViewOptions.dataComp.initializeType&&(e=this.getRealRowIndex(e)),t.setSelectedIndex1(e)})),this.event.addListener(this.itemTable.gridView.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.gridView,(function(e){var i=e.charCode?e.charCode:e.keyCode;if(13==i){t.focus();var s=this.getFocusedRowIndex();"dataList"===t.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),t.setSelectedIndex1(s)}else 27==i&&(t._closeSubLayer(),t.focus())}))),this.setGridViewData();else{if("ul"===this.options.tableRender){var e=this.options.textAlign?"text-align:"+this.options.textAlign+";":"";this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",{row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:e+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_sb",w2table_main:"w2table_sb_ul_main",w2table_row:"w2table_sb_ul_row",w2table_col:"w2table_sb_ul_col",w2table_col_over:this.options.depthColumn?"":"w2table_sb_ul_col_over",escape:this.options.escape,tableRender:this.options.tableRender,wheelRows:this.options.wheelRows,chooseOption:this.options.chooseOption,allOption:this.options.allOption,findItemKor:this.options.findItemKor,findItem:this.options.findItem,keyBufferResetTime:this.options.keyBufferResetTime,parent_uuid:this.uuid,depthColumn:this.options.depthColumn,depthColumnHeight:this.options.depthColumnHeight,depthColumnWidth:this.options.depthColumnWidth})}else this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",{row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:"text-align:"+this.options.textAlign+";"+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_sb",w2table_main:"w2table_sb_main",w2table_row:"w2table_sb_row",w2table_col:"w2table_sb_col",w2table_col_over:"w2table_sb_col_over",escape:this.options.escape,wheelRows:this.options.wheelRows,chooseOption:this.options.chooseOption,allOption:this.options.allOption,findItemKor:this.options.findItemKor,findItem:this.options.findItem,keyBufferResetTime:this.options.keyBufferResetTime,parent_uuid:this.uuid,depthColumn:this.options.depthColumn,depthColumnHeight:this.options.depthColumnHeight,depthColumnWidth:this.options.depthColumnWidth});this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.addClickEventListener((function(e,i){var s,o=e.charCode?e.charCode:e.keyCode,l=t.selectedIndex,r=t.getValue();if(t.focus(),t.options.depthColumn&&(s={skipClose:!0}),t.setSelectedIndex1(i,s),t.options.keyMoveSync||0!=t.options.keyMoveSync||13!=o||"keydown"!==e.type){var a={oldValue:r,newValue:t.getValue(),
oldSelectedIndex:l,newSelectedIndex:t.selectedIndex};n.B.fireEvent(t,"onselected",a)}})),this.itemTable.addKeyDownEventListener((function(e){var i=e.charCode?e.charCode:e.keyCode;t.options.customToggleKey==i?(t._closeSubLayer(),t.focus()):"ul"==this.options.tableRender&&t.itemTable.endReached?(t.itemTable.endReached=!1,t.closeSubLayer(),t.focus()):27==i&&(t._closeSubLayer(),t.focus())})),this.options.keyMoveSync||this.itemTable.addKeyUpEventListener((function(e,i){if(13==(e.charCode?e.charCode:e.keyCode)){var s=t.selectedIndex,o=t.getValue();t.focus(),t.setSelectedIndex1(i);var l={oldValue:o,newValue:t.getValue(),oldSelectedIndex:s,newSelectedIndex:t.selectedIndex};n.B.fireEvent(t,"onselected",l)}})),this.options.keyMoveListSync&&this.itemTable.addOnchangeListener((function(e){try{t.setSelectedIndex1(e,{skipClose:!0})}catch(t){l.w.printStackTrace(t,null,this)}}));var i=WebSquare.idCache[this.uuid],s=this.options.closeonmouseleave,o=this.options.itemTooltipDisplay;(s||o)&&this.itemTable.addMouseLeaveEventListener((function(e){if(s){var l=t.render.offsetHeight,n=t.getAbsolutePosition("top");e.clientY>=n&&e.clientY<=n+l||t.closeSubLayer()}o&&i.hideTooltip()})),o&&this.itemTable.addMouseOverEventListener((function(t){var e=r.D.getDataPrefix("index"),s=t,o=WebSquare.style.getAbsoluteLeft(s)+20,l=WebSquare.style.getAbsoluteTop(s)+s.offsetHeight+3,n="ul"===i.options.tableRender?s.innerText:s.innerHTML;if(i.itemTooltipFormatter&&"function"==typeof i.itemTooltipFormatter){var a=parseInt(s.getAttribute(e),10);n=i.itemTooltipFormatter(n,a,i.options._rowIndex,i.options._colIndex)}i.showTooltip(o,l,n)})),this.setSelectOptions(),this.setItemTable()}var a=document.getElementById(this.id+"_main_tbody");a&&a.setAttribute("aria-controls",this.id+"_itemTable")}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setGridData=function(){try{if(this.itemTable.grid.setData(this.gridItemArr),this.options.allOption&&this.gridItemArr.length>0){for(var t=[],e=-1,i=0;i<this.itemsetObj.items.length;i++)-1==e&&this.itemsetObj.items[i].ref==this.itemsetObj.label&&(e=i),t.push("");t[-1==e?0:e]=this.defaultAllOptionLabel,this.itemTable.grid.setRowData(0,t,!1)}if(this.itemsetObj.sortIndex&&this.gridItemArr.length>0){var s=[];if(this.options.allOption){var o=this.itemsetObj.sortIndex.split(" ")[0],n=this.itemTable.grid.getCellInfo(o).options.dataType,r=parseInt(this.itemsetObj.sortOrder.split(" ")[0],10);s[0]=function(t,e,i,s){return 0==i?-1:0==s?1:("number"==n?(t=Number(t),e=Number(e)):(t=t||"",e=e||""),t>e?1*r:t<e?-1*r:0)}}this.itemTable.grid.multisort({sortIndex:this.itemsetObj.sortIndex,sortOrder:this.itemsetObj.sortOrder,sortFuncArr:s})}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setGridViewData=function(){try{var t=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList);if(t.removeAll(),t.setData(this.gridViewOptions.dataComp.getAllFilteredData()),this.options.allOption||this.options.chooseOption){for(var e=[],i=-1,s=0;s<this.itemsetObj.items.length;s++)-1==i&&this.itemsetObj.items[s].ref==this.itemsetObj.label&&(i=t.bodyIdColIndexMap[this.itemsetObj.label]),e.push("");this.options.allOption&&(e[-1==i?0:i]=this.defaultAllOptionLabel,t.setRowData(0,e,!1)),this.options.chooseOption&&(e[-1==i?0:i]=this._getChooseOptionLabel(),t.setRowData(0,e,!1))}for(var o=this.gridViewItemArr.length>0&&this.itemTable.gridView.delayedDrawObj&&this.itemTable.render&&"none"===this.itemTable.render.style.display,n=0;n<this.itemArr.length;n++)this.itemArr[n]._hidden?this.itemTable.gridView.setRowVisible(n,!1):this.itemTable.gridView.setRowVisible(n,!0);o&&this.itemTable.show(),this.itemTable.gridView.notifyDataChanged({keepTop:!0}),o&&this.itemTable.hide()}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setSelectOptions=function(){try{null!=this.itemTable&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&!0!==this.refreshStopItemTable&&this.itemTable.setItemArr(this.itemArr)}catch(t){l.w.printStackTrace(t,null,this)}},
p.prototype.setItemTable=function(){try{var t=this.render.offsetWidth,e=document.body.offsetWidth,i=0,s=WebSquare.style.getAbsoluteLeft(this.render),n=WebSquare.style.getAbsoluteTop(this.render),r=this.itemTable.render.getElementsByTagName("td");if("ul"===this.options.tableRender&&(r=this.itemTable.render.getElementsByTagName("li")),this.options.depthColumn);else if(r&&r.length>0){for(var a=this.options.visibleRowNum,h=0,d=0;d<this.itemArr.length&&a>0;d++)this.options.visibleColumn&&this.options.visibleColumnFalseValue&&!0===this.itemArr[d]._hidden||(i+=r[d].offsetHeight,a--,h++);o.v.browserCheck.moz&&i<34&&1===h&&(i=34),this.itemTable.setStyle("height",i+"px")}else this.itemTable.setStyle("height","0px");"auto"==this.itemTable.getStyle("overflow-x")&&(i+=20,this.itemTable.setStyle("height",i+"px"));var p=WebSquare.style.getSize(this.itemTable.render,"outerwidth")-WebSquare.style.getSize(this.itemTable.render,"width");if(this.options.depthColumn);else if("fixed"==this.options.submenuSize)this.itemTable.setStyle("width",t-p+"px"),this.itemTable.render.offsetHeight>=this.itemTable.render.scrollHeight?this.itemTable.render.firstChild.style.width=t+"px":this.itemTable.render.firstChild.style.width=t-17+"px";else if("auto"==this.options.submenuSize){var c,u=this.render.offsetWidth,m=WebSquare.style.getSize(this.itemTable.render,"innerwidth")-WebSquare.style.getSize(this.itemTable.render,"width"),b=this.itemTable.render.clientWidth-m;if(e>u&&e<b&&(b=e-p),b=u-p,this.itemTable.setStyle("width",b+"px"),this.itemTable.render.clientHeight>=this.itemTable.render.scrollHeight||this.getItemCount()<=this.options.visibleRowNum)this.itemTable.render.firstChild.style.width=b+"px",(c=this.itemTable.render.scrollWidth-p)>b&&(this.itemTable.render.firstChild.style.width=c+"px",this.itemTable.setStyle("width",c+"px"));else this.itemTable.render.firstChild.style.width=b-17+"px",(c=this.itemTable.render.scrollWidth-p)>e&&(c=e-17),c>b-17&&(this.itemTable.render.firstChild.style.width=c+"px",this.itemTable.setStyle("width",c+17+"px"));0===this.getItemCount()&&(this.itemTable.setStyle("width","0px"),this.itemTable.render.firstChild.style.width="0px")}else this.itemTable.render.scrollHeight-this.itemTable.render.offsetHeight>1&&this.itemTable.setStyle("width",this.itemTable.render.firstChild.offsetWidth+17+"px");var f=this.options.direction;if("auto"==f){var y=document.body.scrollTop;y<document.documentElement.scrollTop&&(y=document.documentElement.scrollTop);var g=WebSquare.style.getScale(),v=(n-y)*g,T=document.documentElement.clientHeight-(v+this.render.offsetHeight),S=this.itemTable.render.offsetHeight*g,I=Math.max(T,v);if(I<S&&r&&r.length>0){if(!this.options.depthColumn){var w=0;for(d=0;d<r.length&&!(w+r[d].offsetHeight+2>I);d++)w+=r[d].offsetHeight;this.itemTable.rowCount=d,this.itemTable.setStyle("height",w+"px")}I!==T&&(f="up")}else T<S&&v>S&&(f="up")}if("up"==f?n-=this.itemTable.render.offsetHeight:n+=this.render.offsetHeight,this.options.depthColumn);else if(document.documentElement.clientWidth<s+this.itemTable.render.offsetWidth)(s=s+this.render.offsetWidth-this.itemTable.render.offsetWidth)<0?(s=WebSquare.style.getAbsoluteLeft(this.render),b=document.body.offsetWidth-17-s,this.itemTable.setStyle("width",b+"px"),"auto"!=this.itemTable.getStyle("overflow-x")&&(i+=20),this.itemTable.setStyle("height",i+"px"),this.itemTable.setStyle("overflow-x","auto")):this.itemTable.setStyle("overflow-x","hidden");else{b=this.itemTable.render.firstChild.offsetWidth;var x=this.itemTable.render.clientWidth;if(s+b<e&&"auto"==this.itemTable.getStyle("overflow-x")){var C=b>x?b:x;i-=20,this.itemTable.setStyle("height",i+"px"),this.itemTable.setStyle("width",C+"px"),this.itemTable.setStyle("overflow-x","hidden")}}this.itemTableDirection=f,this.itemTable.render.style.left=s+"px",this.itemTable.render.style.top=n+"px",WebSquare.style.adjustZIndex(this.uuid,this.itemTable.uuid,"itemTable")}catch(t){l.w.printStackTrace(t,null,this)}},
p.prototype.setSelectItemArr=function(){try{if(""!=this.options.sortOption){var t=[],e=null;"label"==this.options.sortOption?e=function(){return this.label}:"value"==this.options.sortOption&&(e=function(){return this.value});for(var i=0;i<this.itemArr.length;i++){var s=this.itemArr[i];s.toString=e,t.push(s)}t.sort(),"descending"==this.options.sortMethod&&t.reverse(),this.itemArr=t}for(i=0;i<this.itemArr.length;i++)this.itemArr[i].orgLabel=this.itemArr[i].orgLabel||this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i);if("all"==this.options.optionOrder){if(1==this.options.chooseOption){var o=this._getChooseOptionLabel();o=WebSquare.xml.decode(o).replace("&nbsp;"," "),this.itemArr=[{label:o,value:this.options.chooseOptionValue}].concat(this.itemArr)}1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr))}else if(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr)),1==this.options.chooseOption){o=this._getChooseOptionLabel();o=WebSquare.xml.decode(o).replace("&nbsp;"," "),this.itemArr=[{label:o,value:this.options.chooseOptionValue}].concat(this.itemArr)}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.toggle=function(){try{this.isOpen?this.closeSubLayer():this.openSubLayer()}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.openSubLayer=function(){try{WebSquare.getBody().getLayerListener().show(this.id)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype._openSubLayer=function(){try{if(this.setSubLayer(),!this.isOpen){this.itemTable.show(),this.addClass("w2selectbox_open");var t=document.getElementById(this.id+"_main_tbody");if(t&&t.setAttribute("aria-expanded","true"),this.setItemTable(),1==this.options.wmode&&WebSquare.getBody().showWModeFrame(this.getPluginName(),this.itemTable.render),r.D.isMobile()||this.itemTable.focus(),"ul"==this.options.tableRender&&(this.itemTable.removeClass(this.itemTable.selectedCell,this.itemTable.options.w2table_col_over),this.itemTable.selectedCell=null),this.options.emptyItem?this.itemTable.setSelectedIndex(this.selectedIndex,{noChangeFunc:!0}):-1!=this.selectedIndex&&this.itemTable.setSelectedIndex(this.selectedIndex),""!=this.options.animation&&"string"==typeof this.options.animation){var e="down",i=WebSquare.style.getAbsoluteTop(this.render),s=document.body.scrollTop;s<document.documentElement.scrollTop&&(s=document.documentElement.scrollTop);var o=i-s,n=document.documentElement.clientHeight-(o+this.render.offsetHeight),a=this.itemTable.render.offsetHeight;n<a&&o>a&&(e="up"),"show"==this.options.animation.toLowerCase()?$("#"+this.itemTable.id).hide().show("fast"):"fadein"==this.options.animation.toLowerCase()?$("#"+this.itemTable.id).hide().fadeIn("slow"):"slidedown"==this.options.animation.toLowerCase()&&"down"==e&&$("#"+this.itemTable.id).hide().slideDown("fast")}this.isOpen=!0,this.options.customLabelFormatter&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex)}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype._openOtherLayer=function(){try{var t=this.otherComponent;if("grid"==this.itemTableMode?(this.setSubLayer(),this.setGridData(),""!==this.gridOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.grid.render.style.height),t=this.itemTable):"gridView"==this.itemTableMode&&(this.setSubLayer(),this.setGridViewData(),""!==this.gridViewOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.gridView.render.style.height),t=this.itemTable),!this.isOpen){t.setPosition(0,0),t.show(),this.addClass("w2selectbox_open");var e=WebSquare.style.getAbsoluteLeft(this.render),i=WebSquare.style.getAbsoluteTop(this.render),s=this.options.direction;if("auto"==s){var o=document.body.scrollTop;o<document.documentElement.scrollTop&&(o=document.documentElement.scrollTop)
;var n=i-o,a=document.documentElement.clientHeight-(n+this.render.offsetHeight),h=t.render.offsetHeight;a<h&&n>h&&(s="up")}"up"==s?"gridView"==this.itemTableMode?i-=t.gridView.render.offsetHeight:i-=t.grid.render.offsetHeight:i+=this.render.offsetHeight,"auto"==this.options.submenuSize&&"gridView"==this.itemTableMode&&(e=WebSquare.style.getAbsoluteLeft(this.render),this.gridViewOptions.width||(t.render.style.width=this.render.offsetWidth+"px")),document.documentElement.clientWidth<e+t.render.offsetWidth&&(e=e+this.render.offsetWidth-t.render.offsetWidth),e<0&&(e=0),t.render.style.left=e+"px",t.render.style.top=i+"px",this.isOpen=!0,this.itemTableDirection=s,WebSquare.style.adjustZIndex(this.uuid,t.uuid,"itemTable"),!r.D.isMobile()&&this.options.findItemFirstKey&&("grid"==this.itemTableMode?t.grid.render.focus():"gridView"==this.itemTableMode&&t.gridView.render.focus())}-1!=this.selectedIndex&&this.itemTable.setSelectedIndex(this.selectedIndex)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.closeSubLayer=function(t){try{var e={documentClick:t};null!=this.itemTable&&("grid"==this.itemTableMode?this.itemTable.grid.applyFocusedCellOut(this.itemTable.grid.focusedCell[0]):"gridView"==this.itemTableMode&&this.itemTable.gridView.applyFocusedCellOut(this.itemTable.gridView.focusedCell[0])),WebSquare.getBody().getLayerListener().hide(this.id,e)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype._closeSubLayer=function(t){try{var e=(t=t||{}).documentClick;if(this.isOpen&&null!=this.itemTable){this.itemTable.hide(),this.removeClass("w2selectbox_open"),this.itemTable.render.setAttribute("aria-expanded","true"),1==this.options.wmode&&WebSquare.getBody().hideWModeFrame(this.getPluginName(),this.itemTable.id),this.isOpen=!1,this.options.customLabelFormatter&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex),!0===e?n.B.fireEvent(this,"onclose",!0):n.B.fireEvent(this,"onclose",!1);var i=document.getElementById(this.id+"_main_tbody");i&&i.setAttribute("aria-expanded","false")}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype._closeOtherLayer=function(t){try{var e=(t=t||{}).documentClick,i=this.otherComponent;"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(i=this.itemTable),this.isOpen&&null!=i&&(i.hide(),this.removeClass("w2selectbox_open"),this.isOpen=!1,!0===e?n.B.fireEvent(this,"onclose",!0):n.B.fireEvent(this,"onclose",!1))}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setSelectedIndex=function(t,e){try{if(t=parseInt(t,10),isNaN(t))return;if(t<0||t>=this.getItemCount()){if(this.options.emptyItem)if(this.modelControl.isBinded())(1==this.options.selectedData||0!=e)&&this.modelControl.setData(this.options.emptyValue),this.setSelectedIndexNM(-1);else{var i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(-1),-1!=i&&n.B.fireEvent(this,"onchange",{oldValue:s,newValue:this.getValue()})}return}if(this.modelControl.isBinded()){var o=this.modelControl.dataCollectionRefInfo?this.modelControl.dataCollectionRefInfo.dataComp:null;1==this.options.selectedData?(this.modelControl.setData(this.itemArr[t].value),null==o||o.getBroadcast()||this.setSelectedIndexNM(t)):0!=e?this.itemArr[t].value!=WebSquare.allValue?(this.modelControl.setData(this.itemArr[t].value),1==this.options.chooseOption&&0==t?this.setSelectedIndexNM(0):null==o||o.getBroadcast()||this.setSelectedIndexNM(t)):(this.modelControl.setData(""),this.setSelectedIndexNM(t)):this.setSelectedIndexNM(-1)}else{i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(t),i!=this.getSelectedIndex()&&n.B.fireEvent(this,"onchange",{oldValue:s,newValue:this.getValue()})}this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setSelectedIndexNM=function(t){try{return t=parseInt(t,10),
isNaN(t)?!1:t<0||t>=this.getItemCount()?!!this.options.emptyItem&&(this.selectedIndex=-1,this.dom.label.innerHTML="",this.itemTable&&this.itemTable.setSelectedIndex(0),!0):(this.selectedIndex=t,this._setLabel(t),this.itemTable&&this.render.setAttribute("aria-activedescendant",this.itemTable.id+"_"+t),!0)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setAllSelectedIndex=function(t,e){try{if(!this.allItemArr[t])return this.selectedAllIndex=-1,!1;this.selectedIndex=-1,this.selectedAllIndex=t;var i=this.allItemArr[t].label+"";return this.dom.label&&(this.dom.label.innerHTML=this._getLabel(i)),e&&this.modelControl.setData(this.allItemArr[t].value),NaN}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.getSelectedIndex=function(){try{return this.selectedIndex}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.getSelectedRow=function(){try{if("gridView"==this.itemTableMode&&this.itemTable){var t=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList);if(t)return t.getRowArray(this.getSelectedIndex())}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setValue=function(t){try{var e=!0;if(r.D.isNull(t))return!1;var i=this.getValue();if(this.modelControl.isBinded())this.modelControl.setData(t);else{i=this.getValue();var s=this.setValueNM(t);1==s?i!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:i,newValue:this.getValue()}):isNaN(s)||(this._setValueNotInList(t),e=!1)}return this.broadcast({linkedDataList:["refresh",["replace"]]}),e}catch(t){return l.w.printStackTrace(t,null,this),!1}},p.prototype.setValueNM=function(t){try{if(r.D.isNull(t))return;t=t.toString();for(var e=this.getItemCount(),i=0;i<e;i++)if(this.itemArr[i].value==t)return this.setSelectedIndexNM(i),!0;return this.setAllValue(t)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setAllValue=function(t,e){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(t){return!1}if(r.D.isNull(t))return!1;t=t.toString();for(var i=this.allItemArr.length,s=0;s<i;s++)if(this.allItemArr[s].value==t)return this.setAllSelectedIndex(s,e);return!1}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype._setValueNotInList=function(t,e){try{switch(this.options.valueNotInList){case"keepValue":if(t)if(this.selectedIndex=-1,null!=this.dom.label.textContent)this.dom.label.textContent=t;else if(null!=this.dom.label.innerText)this.dom.label.innerText=t;else{var i=this._getLabel(t);this.dom.label.innerHTML=i}else this.options.emptyItem?this.setSelectedIndex(-1):this.setSelectedIndex(0);break;case"default":default:this.options.emptyItem?this.setSelectedIndex(-1,e):this.setSelectedIndex(0,e)}}catch(t){return l.w.printStackTrace(t,null,this),!1}},p.prototype.getValue=function(){try{if(this.itemArr[this.selectedIndex])return this.itemArr[this.selectedIndex].value;var t=this.getAllValue();return!1!==t?t:this._getValueNotInList()}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.getAllValue=function(t,e){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(t){return!1}return!!this.allItemArr[this.selectedAllIndex]&&this.allItemArr[this.selectedAllIndex].value}catch(t){return l.w.printStackTrace(t,null,this),!1}},p.prototype._getValueNotInList=function(){try{switch(this.options.valueNotInList){case"keepValue":return(null!=this.dom.label.textContent?this.dom.label.textContent:null!=this.dom.label.innerText?this.dom.label.innerText:this.dom.label.innerHTML)||(this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null);case"default":default:return this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null}}catch(t){return l.w.printStackTrace(t,null,this),null}},p.prototype.setText=function(t,e){try{
var i=this.getItemCount(),s="";if(e)for(var o=0;o<i;o++)this.itemArr[o].orgLabel==t&&(s=this.itemArr[o].value);else for(o=0;o<i;o++)this.itemArr[o].label==t&&(s=this.itemArr[o].value);this.setValue(s)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.getText=function(t){try{return this.itemArr[this.selectedIndex]?t?this.itemArr[this.selectedIndex].orgLabel:this.itemArr[this.selectedIndex].label:this.options.emptyItem&&-1==this.selectedIndex?"":null}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.addItemArr=function(t,e,i){try{!0===i||!1===i?this.itemArr.push({label:t,value:e,_hidden:i}):this.itemArr.push({label:t,value:e})}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.addItem=function(t,e,i,s){try{if(i=parseInt(i,10),(isNaN(i)||i<0||i>=this.getItemCount())&&(i=this.getItemCount()),null==s&&(s=this.options.dataListAutoRefresh),this.itemsetObj.nodeset.match("data:")&&s){var o=this.modelControl.getDataComp();if(o&&WebSquare.idCache[o.uuid]){var n={};n[this.itemsetObj.value]=t,n[this.itemsetObj.label]=e,this.stopRefresh(!0),o.insertJSON(i,[n]),this.stopRefresh(!1)}}var r={};return r.value=t,r.label=e,this.itemArr.splice(i,0,r),"0"!=this.options.displayMode&&(this.itemArr[i].orgLabel=this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i)),this.options.emptyItem&&-1==this.selectedIndex&&this.setSelectedIndex(0),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),i}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.deleteItem=function(t,e){try{if(t=parseInt(t,10),isNaN(t))return;if(null==e&&(e=this.options.dataListAutoRefresh),this.itemsetObj.nodeset.match("data:")&&e){var i=this.modelControl.getDataComp();if(i&&WebSquare.idCache[i.uuid]){var s=0;this.options.chooseOption&&s++,this.options.allOption&&s++,this.stopRefresh(!0),i.removeRow(t-s),this.stopRefresh(!1)}}var o=null;return t>=0&&t<this.getItemCount()&&(o=this.itemArr.splice(t,1)[0]),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),this.options.emptyItem&&(-1!=this.selectedIndex&&t!=this.selectedIndex||this.setSelectedIndex(0)),this.options.emptyItem&&"native"==this.options.renderType?this.selectedIndex>t&&t>=0?this.setSelectedIndex(this.selectedIndex-1):this.setSelectedIndex(this.selectedIndex):this.selectedIndex>t&&t>=0&&this.setSelectedIndex(this.selectedIndex-1),o}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.removeAll=function(t){try{var e=this.getValue();if(this.itemArr=new Array,t&&(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr)),1==this.options.chooseOption)){var i=this._getChooseOptionLabel();i=WebSquare.xml.decode(i).replace("&nbsp;"," "),this.itemArr=[{label:i,value:this.options.chooseOptionValue}].concat(this.itemArr)}if(this.setSelectOptions(this.itemArr),this.dom.label)if(this.itemArr.length>0){i=this._getLabel(this.itemArr[0].label+"");this.dom.label.innerHTML=i}else this.dom.label.innerHTML="";if(this.options.setDataRemoveAll&&(t?this.setSelectedIndex(0):(this.selectedIndex=-1,!this.dom.label&&this.dom.select&&(this.dom.select.selectedIndex=-1),this.modelControl.isBinded()&&this.modelControl.setData(""),e!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:e,newValue:this.getValue()}))),"grid"==this.itemTableMode)this.gridItemArr=[],this.itemTable&&this.itemTable.grid.removeAll();else if("gridView"==this.itemTableMode){if(this.gridViewItemArr=[],this.itemTable)this.modelControl.getDataComp(this.itemTable.gridView.options.dataList).removeAll()}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.onPropertyChange=function(t,e){try{switch(t){case"disabled":
"component"==this.options.renderType?e&&this.closeSubLayer():e?this.dom.select&&this.dom.select.setAttribute("disabled","disabled"):this.dom.select&&this.dom.select.removeAttribute("disabled");var i=this.dom.button;1==e?(this.addClass(this.render,this.options.disabledClass),null!=i&&this.addClass(i,"w2selectbox_button_disabled")):(this.removeClass(this.render,this.options.disabledClass),null!=i&&this.removeClass(i,"w2selectbox_button_disabled"));break;case"mandatory":1==e?this.addClass(this.render,"w2selectbox_mandatory"):this.removeClass(this.render,"w2selectbox_mandatory")}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setSelectedIndex1=function(t,e){try{void 0!==e&&null!=e||(e={});var i=this.selectedIndex,s=this.getValue();if(this.setSelectedIndex(t),i!=this.selectedIndex){var o={oldValue:s,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex};n.B.fireEvent(this,"onviewchange",o)}!0!==e.skipClose&&this.closeSubLayer()}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.validate=function(){try{var t=this.validator.validate(this.getValue());return t||this.focus(),t}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.validateObject=function(){try{var t=this.validator.validate(this.getValue()),e={};return t||(this.focus(),this.validator&&this.validator.obfuscator_invalidObject&&(e.callerId=this.validator.obfuscator_invalidObject.callerId,e.type=this.validator.obfuscator_invalidObject.getType(),e.value=this.validator.obfuscator_invalidObject.getValue())),e}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setInitValue=function(t){try{var e=this.getValue();""===this.options.initValue&&this.itemArr&&this.itemArr[0]&&(this.options.initValue=this.itemArr[0].value),this.setValueNM(this.options.initValue),this.modelControl.setData(this.options.initValue),t.fireEvent&&e!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:e,newValue:this.getValue()})}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.hide=function(){try{this.closeSubLayer(),a.s.prototype.hide.call(this)}catch(t){l.w.printStackTrace(t)}},p.prototype.showTooltip=function(t,e,i){try{if(!i)return;null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var s="";this.options.itemTooltipDisplay&&(s="position:absolute;z-index:10000;");var a=this;this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){try{var h=o.v.getConfiguration("/WebSquare/tooltipShowHideHandler/@value");if(h){var d=r.D.getGlobalFunction(h,a.scope_id),p=!0;if("function"==typeof d&&(p=d(a)),!p)return}}catch(t){l.w.printStackTrace(t)}this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2selectbox_tooltip "+this.options.tooltipClass,style:s}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",t+"px"),this.tooltip.setStyle("top",e+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i,this.isFireTooltipEvent||(this.isFireTooltipEvent=!0,n.B.fireEvent(this,"ontooltipshow"))})),1e3*this.options.tooltipTime)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&(this.tooltip.setStyle("display","none"),n.B.fireEvent(this,"ontooltiphide"),this.isFireTooltipEvent=!1)})),1e3*this.options.tooltipTime)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleClickEvent=function(t){try{if(this.options.disabled)return!1;r.D.isMobile()||this.focus(),this.itemArr.length>0?this.toggle():1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll()}catch(t){
l.w.printStackTrace(t,null,this)}},p.prototype.handleKeydownEvent=function(t){try{var e=t.charCode?t.charCode:t.keyCode,i=this.getSelectedIndex();if(!0===this._preventKeyObj[e]||!0===this._preventKeyObj.all)return;if(13==e&&this.options.keyMoveSync)return void this.handleClickEvent(t);if(this.options.customToggleKey==e)return void this.toggle();if(this.isOpen)return;if(!this.options.keyMoveSync||38!=e&&40!=e&&33!=e&&34!=e&&35!=e&&36!=e)return 9==e?(this.tabOrderMoveStart=!1,void(t.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(t)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(t)))):(this.findItemStartedWithKeyChar(t,e),void(this.options.findItem&&this._keyBuffer&&(r.D.clearTimeout(this.id+"_selectKeyBuffer"),r.D.setTimeout((function(){this._keyBuffer=""}),{key:this.id+"_selectKeyBuffer",caller:this,delay:this.options.keyBufferResetTime}))));if(this._oldIndex=this.selectedIndex,this._oldValue=this.getValue(),38==e)i>0&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(i-1),this.targetFocusedIndex=i-1):this.setSelectedIndex1(i-1));else if(40==e)"grid"==this.itemTableMode||"gridView"==this.itemTableMode?i+1<this.getItemCount()&&(this.setSelectedIndex1(i+1),this.targetFocusedIndex=i+1):i+1<this.getItemCount()&&this.setSelectedIndex1(i+1);else if(33==e){if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(s=i-this.options.visibleRowNum)<0&&(s=0),this.setSelectedIndex1(s),this.targetFocusedIndex=s;else(s=i-this.options.visibleRowNum)<0&&(s=0),this.setSelectedIndex1(s)}else if(34==e){var s;if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(s=i+this.options.visibleRowNum)>=this.getItemCount()&&(s=this.getItemCount()-1),this.setSelectedIndex1(s),this.targetFocusedIndex=s;else(s=i+this.options.visibleRowNum)>=this.getItemCount()&&(s=this.getItemCount()-1),this.setSelectedIndex1(s)}else 35==e?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(this.getItemCount()-1),this.targetFocusedIndex=this.getItemCount()-1):this.setSelectedIndex1(this.getItemCount()-1):36==e&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(0),this.targetFocusedIndex=0):this.setSelectedIndex1(0));if(this._oldIndex!=this.selectedIndex){var o={oldValue:this._oldValue,newValue:this.getValue(),oldSelectedIndex:this._oldIndex,newSelectedIndex:this.selectedIndex};n.B.fireEvent(this,"onselected",o)}n.B.stopEvent(t)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleKeyupEvent=function(t){try{var e,i=t.charCode?t.charCode:t.keyCode;if(!0===this._preventKeyObj[i]||!0===this._preventKeyObj.all)return;if(!this.options.keyMoveSync&&this.modelControl.isBinded()){var s=this.getSelectedIndex();if(13==i){for(var o=this.modelControl.getData(),a=-1,h=0;h<this.itemArr.length;h++)if(this.itemArr[h].value==o){a=h;break}var d={oldValue:o,newValue:this.getValue(),oldSelectedIndex:a,newSelectedIndex:s};this.setSelectedIndex(this.getSelectedIndex()),n.B.fireEvent(this,"onselected",d)}else if(38==i||40==i||33==i||34==i||35==i||36==i)if(this._onSelected=!1,this._oldIndex=this.selectedIndex,this._oldValue=this.getValue(),38==i)s>0&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(s-1),this.targetFocusedIndex=s-1):this.setSelectedIndexNM(s-1));else if(40==i)"grid"==this.itemTableMode||"gridView"==this.itemTableMode?s+1<this.getItemCount()&&(this.setSelectedIndexNM(s+1),this.targetFocusedIndex=s+1):s+1<this.getItemCount()&&this.setSelectedIndexNM(s+1);else if(33==i){if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(p=s-this.options.visibleRowNum)<0&&(p=0),this.setSelectedIndexNM(p),this.targetFocusedIndex=p;else(p=s-this.options.visibleRowNum)<0&&(p=0),this.setSelectedIndexNM(p)}else if(34==i){var p
;if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(p=s+this.options.visibleRowNum)>=this.getItemCount()&&(p=this.getItemCount()-1),this.setSelectedIndexNM(p),this.targetFocusedIndex=p;else(p=s+this.options.visibleRowNum)>=this.getItemCount()&&(p=this.getItemCount()-1),this.setSelectedIndexNM(p)}else 35==i?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(this.getItemCount()-1),this.targetFocusedIndex=this.getItemCount()-1):this.setSelectedIndexNM(this.getItemCount()-1):36==i&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(0),this.targetFocusedIndex=0):this.setSelectedIndexNM(0))}if(9==i||13==i&&this.options.nextTabByEnter)if(null!=WebSquare.tabOrder[this.id])if(t.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(e=r.D.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,e.focus())}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(e=r.D.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,e.focus())}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleMousewheelEvent=function(t){try{if(this.options.preventWheelEvent)return;n.B.stopEvent(t);for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2selectbox_focus")&&!this.isOpen){var i=this.getSelectedIndex();t.wheelDelta>0||t.detail<0?this.setSelectedIndex1(i-1):this.setSelectedIndex1(i+1)}e=null}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleFocusEvent=function(t){try{n.B.stopEvent(t),this.addClass(this.dom.tbody,"w2selectbox_focus"),this.addClass("w2selectbox_body_focus")}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleBlurEvent=function(t){try{n.B.stopEvent(t),this.removeClass(this.dom.tbody,"w2selectbox_focus"),this.removeClass("w2selectbox_body_focus"),this.itemTable&&this.itemTable.itemTableFocus||n.B.fireEvent(this,"onblur",t)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleMouseoverEvent=function(t){try{if(n.B.stopEvent(t),this.addClass(this.dom.tbody,"w2selectbox_over"),this.addClass("w2selectbox_body_over"),!this.isOpen){for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2selectbox")&&(1==this.options.tooltipDisplay||1==this.options.tooltipShowAlways)){var i=e.getElement(),s=this.options.depthColumn?"w2selectbox_ul_label":"w2selectbox_label",o=i.getElementsByClassName(s)[0],r=WebSquare.style.getStyle(o,"text-overflow"),a=this.dom.label.innerHTML;if(!0===this.options.tooltipShowAlways){var h=WebSquare.style.getAbsoluteLeft(i)+20,d=WebSquare.style.getAbsoluteTop(i)+this.render.offsetHeight+3;this.showTooltip(h,d,a)}else if("ellipsis"==r){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),document.body.appendChild(this.toolTipRuler),this.toolTipRuler.className=o.className,this.toolTipRuler.innerHTML=o.innerText,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(o,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(o,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(o,"font-weight");var p=this.toolTipRuler.offsetWidth,c=o.clientWidth;if(3!=o.nodeType){var u=WebSquare.style.getStyle(this.toolTipRuler,"padding-left"),m=WebSquare.style.getStyle(this.toolTipRuler,"padding-right");p-=parseInt(u||"0",10),p-=parseInt(m||"0",10),c-=parseInt(WebSquare.style.getStyle(o,"padding-left"),10),c-=parseInt(WebSquare.style.getStyle(o,"padding-right"),10),c-=parseInt(WebSquare.style.getStyle(i,"padding-left"),10),c-=parseInt(WebSquare.style.getStyle(i,"padding-right"),10)}if(c<p){h=WebSquare.style.getAbsoluteLeft(i)+20,d=WebSquare.style.getAbsoluteTop(i)+this.render.offsetHeight+3;document.body.removeChild(this.toolTipRuler),this.options.tooltipItemLabel&&(a=this.options.tooltipItemLabel),this.showTooltip(h,d,a)}}}
e=null}}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleMouseoutEvent=function(t){try{n.B.stopEvent(t),1!=this.options.tooltipDisplay&&1!=this.options.tooltipShowAlways||this.hideTooltip(),this.removeClass(this.dom.tbody,"w2selectbox_over"),this.removeClass("w2selectbox_body_over")}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.handleMouseleaveEvent=function(t){try{var e=this.render.offsetHeight-1,i=this.render.offsetWidth-1,s=this.getAbsolutePosition("top"),o=this.getAbsolutePosition("left");this.isOpen&&("up"==this.itemTableDirection?(t.clientX<o||t.clientX>o+i||t.clientY>s||t.clinetY>s+e)&&this.closeSubLayer():(t.clientX<o||t.clientX>o+i||t.clientY<s||t.clinetY>s+e)&&this.closeSubLayer())}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.findItemStartedWithKeyChar=function(t,e){try{var i=this.keyCharHash[e],s=-1;if(i){var o=this.korCharHash[e],n=this.korCharHash2[e],a=this.selectedIndex;this.options.findItem?(this._keyBuffer+=i,a=0):(this._keyBuffer=i,a++);for(var h=1;;)if(a%=this.itemArr.length,!0!==this.itemArr[a]._hidden){var d=this.itemArr[a].label.toLowerCase();if(0!=a||!0!==this.options.chooseOption&&!0!==this.options.allOption)if(0!=a&&1!=a||!0!==this.options.chooseOption||!0!==this.options.allOption){var p=!1;o&&!t.shiftKey?p=this.myhelper.startWith(d,o):n&&t.shiftKey&&(p=this.myhelper.startWith(d,n));var c=this.options.findItem?this._keyBuffer:i;if(d.startsWith(c)||p&&r.D.getBoolean(this.options.findItemKor)){s=a;break}if(d.startsWith(c)){this._keyBuffer="",s=a;break}if(h>this.itemArr.length)break;a++,h++}else{if(this.itemArr.length<=2)break;a++}else{if(this.itemArr.length<=1)break;a++}}else a++;if(s>-1)return this.setSelectedIndex1(s),!0}if(-1==s)return this._keyBuffer="",!1}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.setRef=function(t){try{"string"==typeof t&&t.length>0&&(this.modelControl.isBinded()||(this.modelControl.useRef=!0),this.options.ref=t,this.modelControl.setRef(t),this.refresh())}catch(t){l.w.printStackTrace(t)}},p.prototype.unbindRef=function(){try{this.modelControl.isBinded()&&(this.options.ref="",this.modelControl.unbindRef(),this.refresh())}catch(t){l.w.printStackTrace(t)}},p.prototype._setLabel=function(t,e){try{if(!this.dom.label||t<0||t>=this.getItemCount())return;var i=e&&e.skipCustomFormatter;if(t<0||t>=this.getItemCount())return;var s=this.itemArr[t].label+"";if(this.options.customLabelFormatter&&!0!==i&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter){var o=this.itemArr[t].value+"",n=this.itemArr[t].orgLabel+"";(0!=t||!0!==this.options.chooseOption&&!0!==this.options.allOption)&&(0!=t&&1!=t||!0!==this.options.chooseOption||!0!==this.options.allOption)&&(s=this.customLabelFormatter.call(this,n,o,this.isOpen))}else{if(this.options.depthColumn&&this.options.depthColumnShowPath){for(var a=[s],h=this.itemArr[t]._depth,d=t-1;d>=0;d--){var p=this.itemArr[d]._depth;if(p<h&&(a.unshift(this.itemArr[d].label),(h=p)<=1))break}s=a.join(this.options.depthColumnPathDelimiter)}s=this._getLabel(s)}this.dom.label.innerHTML=s}catch(t){l.w.printStackTrace(t)}},p.prototype._getLabel=function(t){try{var e=t;return r.D.isIE()&&parseInt(o.v.browserVersion(),10)<10?(t.indexOf("&")>-1&&(t=t.wq_replaceAll("&","&amp;")),t=this.options.escape?WebSquare.xml._encode(t):t.wq_replaceAll("&amp;nbsp;","&nbsp;").wq_replaceAll("&amp;nbsp","&nbsp;")):this.options.escape&&(t=WebSquare.xml._encode(t)),e}catch(t){l.w.printStackTrace(t)}},p.prototype.setDisplayMode=function(t){try{if("label"==t||"value"==t||"value delim label"==t||"label delim value"==t){var e=this.options.displayMode;this.options.displayMode=t,this._initDisplayMode(),e!=this.options.displayMode&&this._refreshItemTable()}}catch(t){l.w.printStackTrace(t)}},p.prototype.setDelimiter=function(t){try{this.options.delimiter!=t&&(this.options.delimiter=t||"\t",
"0"!=this.options.displayMode&&"3"!=this.options.displayMode&&this._refreshItemTable())}catch(t){l.w.printStackTrace(t)}},p.prototype._refreshItemTable=function(){try{if(this.isOpen&&this.closeSubLayer(),this.setSelectItemArr(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode)if(this.itemTable)this.itemTable.setItemArr(this.itemArr);else if("native"===this.options.renderType){var t=this.getSelectedIndex();this.componentRedraw(),this.setSelectedIndexNM(t)}this._setLabel(this.getSelectedIndex())}catch(t){l.w.printStackTrace(t)}},p.prototype._getChooseOptionLabel=function(t){try{var e;if("$blank"===this.options.chooseOptionLabel)e="";else if(e=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef){var i=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef);i&&(e=i)}return e}catch(t){l.w.printStackTrace(t)}},p.prototype.stopRefresh=function(t){try{this.refreshStop=r.D.getBoolean(t)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.stopRefreshItemTable=function(t){try{this.refreshStopItemTable=r.D.getBoolean(t)}catch(t){l.w.printStackTrace(t,null,this)}},p.prototype.focus=function(){"ul"==this.options.tableRender?this.dom.tbody.focus():this.render.focus()},p.prototype.setDisabled=function(t){try{t=r.D.getBoolean(t),this.options.disabled=t,this.setProperty("disabled",t),!0===t?this.render.removeAttribute("tabIndex"):this.render.setAttribute("tabIndex",this.options.tabIndex||0)}catch(t){l.w.printStackTrace(t)}return t},p.prototype.serialize=function(){return{selectedIndex:this.getSelectedIndex()}},p.prototype.restore=function(t){this.setSelectedIndex(t.selectedIndex)};var c=function(t,e,i){a.s.call(this,t,e,i)};s.x.extend(c.prototype,p.prototype),c.prototype.defaultOptions={pluginType:"uiplugin.selectbox",pluginName:"selectbox",renderType:"native",userEvents:["onchange","onclose","onviewchange","onfocus"],useConfig:!0,value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",displayMode:"0",delimiter:"\t",textAlign:"",useLocale:!1,disabledClass:"w2selectbox_disabled",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",dataListAutoRefresh:!1,refreshSelectedIndex:!1,title:"",emptyItem:!1,emptyValue:"",emptyIndex:0,findItem:!1,initStyle:!1},c.prototype.initialize=function(t){try{this._initializeCommon(t&&"$blank"==t.getAttribute("chooseOptionLabel")),this.initializeItemArr(t)}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.finalize=function(){a.s.prototype.finalize.call(this)},c.prototype.toHTML=function(){try{var t=[],e=this.options.style?"style='"+this.options.style+"'":"",i=this.options.title?"title='"+this.options.title+"'":"";if("select"==this.options.renderType){var s=this.options.textAlign?"style='text-align:"+this.options.textAlign+";"+this.options.style+"'":e;t.push("<select id='"+this.id+"' "+s+" class='w2selectbox_select "+this.options.className+"' "+i+">");for(var o=0;o<this.itemArr.length;o++)t.push("<option>"+this.itemArr[o].label+"</option>");t.push("</select>")}else{var n=this.options.textAlign?"style='text-align:"+this.options.textAlign+"'":"";t.push("<div id='"+this.id+"' "+e+" class='w2selectbox_native "+(r.D.isMobile()?"w2selectbox_native_mobile ":"")+(this.options.labelWidthAuto?"":"fixedWidth ")+this.options.className+"'>"),t.push("<div class='w2selectbox_native_innerDiv'>"),t.push("<select class='w2selectbox_native_select' id='"+this.id+"_input_0' "+i+n+">");for(o=0;o<this.itemArr.length;o++)t.push("<option>"+this.itemArr[o].label+"</option>");t.push("</select>"),t.push("</div>"),t.push("</div>")}return t.join("")}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.setPreAction=function(){try{if(this.dom.select="select"==this.options.renderType?this.render:this.render.firstChild.firstChild,
!(r.D.isIE(6)||r.D.isIE(7))&&"native"==this.options.renderType){var t=this.render.clientHeight-this.dom.select.offsetHeight;t>0&&(this.dom.select.style.marginTop=parseInt(t/2,10)+"px")}!0===this.options.labelWidthAuto&&(this.render.style.width=""),this.modelControl.isItemsetBinded()&&(this.refreshItemArr(),this.componentRedraw())}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var t=document.getElementById(this.id).style.cssText,e=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:t,className:e}}if(this.modelControl.isBinded()){var i=this.modelControl.getData();this.setValueNM(i)}if(-1==this.selectedIndex&&this.getItemCount()>0&&(0==this.options.emptyIndex||!this.options.emptyIndex))if(this.modelControl.isBinded()){i=this.getValue();if(this.options.emptyRef){for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value==i){this.setSelectedIndexNM(0),this.modelControl.setData(i);break}}else this.setSelectedIndexNM(0),this.modelControl.setData(i)}else this.setSelectedIndexNM(0),this.broadcast({linkedDataList:["refresh",["replace"]]});else if(this.getItemCount()>0&&this.modelControl.isBinded()&&(0==this.options.emptyIndex||!this.options.emptyIndex)){i=this.getValue();this.modelControl.getData()!==i&&this.modelControl.setData(i)}else this.options.emptyIndex&&"number"==typeof this.options.emptyIndex&&(this.modelControl.isBinded()?(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(this.options.emptyIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})));this.options.mandatory&&this.onPropertyChange("mandatory",r.D.getBoolean(this.options.mandatory)),this.event.addListener2(this.dom.select,"onchange",this.event.bindAsEventListener(this,this.handleOnchange)),this.event.addListener(this.dom.select,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.dom.select,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),this.event.addListener(this.dom.select,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener(this.dom.select,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyupEvent))}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.componentRedraw=function(t,e,i){try{if(this.refreshStop)return;this.showRowIndex=0;var s=0;if(this.options.refreshSelectedIndex&&"setCellData"===i&&(s=this.getSelectedIndex()),this.setSelectOptions(),this.itemArr.length>0){if(this.options.refreshSelectedIndex&&"setCellData"===i)return void this.setSelectedIndexNM(s);if(e||"insertRow"===i){var o=0;return"insertRow"!==i&&"replace"!=e&&this.getSelectedIndex()>-1&&(o=this.getSelectedIndex()),this.dom.select.selectedIndex=o,void(this.selectedIndex=o)}this.dom.select.selectedIndex=0,this.selectedIndex=0}this.setValueNM("")}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.refreshVisible=function(){try{for(var t=0;t<this.itemArr.length;t++)!0===this.itemArr[t]._hidden&&this.dom.select?this.dom.select.options[t].style.display="none":this.dom.select.options[t].style.display=""}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.refreshEnable=function(){try{for(var t=0;t<this.itemArr.length;t++)!0===this.itemArr[t]._disabled&&this.dom.select?this.dom.select.options[t].setAttribute("disabled",""):this.dom.select.options[t].removeAttribute("disabled")}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.setSelectOptions=function(){try{for(var t=this.dom.select.options.length;t>=0;t--)this.dom.select.remove(t);for(t=0;t<this.itemArr.length;t++){var e=document.createElement("option");e.text=this.itemArr[t].label,this.dom.select.options[t]=e,!0===this.itemArr[t]._hidden&&(this.dom.select.options[t].style.display="none"),
!0===this.itemArr[t]._disabled&&this.dom.select.options[t].setAttribute("disabled","")}}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.setSelectedIndexNM=function(t){try{return t=parseInt(t),!this.options.emptyItem&&(isNaN(t)||t<0||t>=this.getItemCount())?!1:(this.selectedIndex=t,this.dom.select&&(this.dom.select.selectedIndex=t),this.broadcast({linkedDataList:["refresh",["replace"]]}),!0)}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.handleOnchange=function(t){var e=this.dom.select.selectedIndex,i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(e),this.options.emptyItem&&-1==e?this.modelControl.setData(this.options.emptyValue):this.modelControl.setData(this.itemArr[e].value);var o=this.getValue();if(this.selectedIndex=e,i!=this.getSelectedIndex()){n.B.fireEvent(this,"onchange",{oldValue:s,newValue:o});var l={oldValue:s,newValue:o,oldSelectedIndex:i,newSelectedIndex:this.selectedIndex};n.B.fireEvent(this,"onviewchange",l)}},c.prototype.handleKeydownEvent=function(t){try{if(9==(t.charCode?t.charCode:t.keyCode))return this.tabOrderMoveStart=!1,void(t.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(t)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(t)))}catch(t){l.w.printStackTrace(t)}},c.prototype.handleKeyupEvent=function(t){try{var e;if(9==(t.charCode?t.charCode:t.keyCode))if(null!=WebSquare.tabOrder[this.id])if(t.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(e=r.D.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,e.focus())}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(e=r.D.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,e.focus())}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.handleBlurEvent=function(t){try{n.B.fireEvent(this,"onblur")}catch(t){l.w.printStackTrace(t,null,this)}},c.prototype.handleFocusEvent=function(t){n.B.fireEvent(this,"onfocus")},c.prototype.focus=function(){this.dom.select.focus()},c.prototype.setDisabled=function(t){try{t=r.D.getBoolean(t),this.options.disabled=t,this.onPropertyChange("disabled",t)}catch(t){l.w.printStackTrace(t)}return t},c.prototype._getValueNotInList=function(){try{switch(this.options.valueNotInList){case"keepValue":case"default":default:return this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null}}catch(t){return l.w.printStackTrace(t,null,this),null}},c.prototype._setValueNotInList=function(t,e){try{switch(this.options.valueNotInList){case"keepValue":case"default":default:this.options.emptyItem?this.setSelectedIndex(-1,e):this.setSelectedIndex(0,e)}}catch(t){return l.w.printStackTrace(t,null,this),!1}}}}]);